/*- Implicit Sources */
define("text!vcl-comps/App.v1.console.js", "$([\"App.v1\", \"App.console\", \"App\"]);");
define("text!vcl-comps/App.v1.js", "$([\"vcl/prototypes/App.v1\", \"App\"]);");
define("text!vcl-comps/App.console.js", "$([\"vcl/prototypes/App.console\", \"App\"]);");
define("text!vcl/prototypes/App.openform.toast.js", "$([\"vcl/prototypes/App.openform\", \"vcl/prototypes/App.toast\", \"vcl/prototypes/App\"]);");
define("text!vcl-comps/ui/Form.js", "$([\"vcl/prototypes/ui/Form\"]);");
define("text!vcl-comps/ui/controls/Toolbar.js", "$([\"vcl/prototypes/ui/controls/Toolbar\"]);");
define("text!vcl-comps/devtools/DragDropHandler$/dropbox.js", "$([\"devtools/DragDropHandler\"]);");
define("text!vcl-comps/ui/controls/SizeHandle.js", "$([\"vcl/prototypes/ui/controls/SizeHandle\"]);");
define("text!vcl/prototypes/devtools/Navigator.js", "$([\"devtools/Navigator\"]);");
define("text!vcl-comps/devtools/Editor$/txt.js", "$([\"devtools/Editor\"]);");
define("text!vcl-comps/devtools/Workspace$/code.build.js", "$([\"devtools/Workspace<code>\"]);");


/*- Sources */
define("text!vcl-comps/devtools/App.js", "\"vcl/ui/Ace, js/Method, vcl/Factory, vcl/ui/FormContainer\";var Ace=require(\"vcl/ui/Ace\");var Method=require(\"js/Method\");var Factory=require(\"vcl/Factory\");var FormContainer=require(\"vcl/ui/FormContainer\");var Panel=require(\"vcl/ui/Panel\");var handlers={onGetStorageKey(forKey){if(forKey.length===2){var comp=forKey[0];var resource=comp.vars([\"resource\"]);if(resource){var ws=comp.up(\"devtools/Workspace<>\");return js.sf(\"%s %s %s\",ws.getUri(),comp.getUri(),resource.uri);}}},loaded(){var scope=this.scope(),me=this;this.open=function(uri,opts){if(typeof uri===\"string\"){opts=opts||{};opts.uri=uri;}else{opts=uri;uri=opts.uri;}\nreturn new Promise(function(resolve,reject){if(opts.modal===true){alert(\"don't know about modal\");resolve(scope.openform_modal.execute(opts));}else{if(!opts.workspace){opts.workspace={name:opts.name||uri};opts.selected=true;}\nvar tab=me.down(\"devtools/Main<>:root #workspace-needed\").execute(opts);var ws=tab._control&&tab._control._form;if(ws){resolve(ws);}else{tab._control.once(\"formloaded\",function(){ws=tab._control&&tab._control._form;resolve(ws);});}}});};var blurred=new Panel();blurred.hide();blurred.setOwner(this);blurred.setName(\"blurry\");var timeout;function update(hidden){var tab=me.qs(\"devtools/Workspace<>:root:selected devtools/Editor<>:root\");var s=js.sf(\"%H\",document.title.split(\"[\").pop().split(\"]\").shift());tab=tab||{_name:\"unknown\"};blurred.setContent(\"<span class='name'>\"+s+\"</span><div class='host'>\"+js.sf(\"%H @ %H\",tab._name.split(\"/\").pop(),location.host)+\"</div>\");if(timeout)clearTimeout(timeout);if(hidden){timeout=setTimeout(function(){blurred.show();},500);}else{blurred.hide();}}\"alert,confirm,prompt\".split(\",\").map(function(method){var impl=window[method];window[method]=function(){blurred.vars(\"dialog-activated\",true);try{return impl.apply(this,arguments);}finally{}};});var mousemoved=0;window.addEventListener(\"focus\",function(e){if(blurred.vars(\"dialog-activated\")===true){update(false);}},false);window.addEventListener(\"blur\",function(e){if(!blurred._visible){update(true);mousemoved=0;}},false);window.addEventListener(\"keyup\",function(e){if(blurred._visible){update(false);}},false);window.addEventListener(\"mouseup\",function(e){if(blurred._visible){update(false);}},false);window.addEventListener(\"mousemove\",function(e){if(mousemoved++>2){if(blurred._visible&&!document.hidden){update(false);}}},false);update(document.hidden);}};(function OverridesAndOtherHacks(){Method.override(Ace.prototype,\"onnodecreated\",function(){var r=this.inherited(arguments);this._editor.commands.removeCommand(\"duplicateSelection\");return r;});Method.override(Factory,{resolveUri:function(uri){var r=js.inherited(this,arguments);var i=uri.indexOf(\"/vcl-comps/\"),l=\"/vcl-comps/\".length;if(uri.indexOf(\"vcl/prototypes/$HOME/\")===0&&i!==-1){r=String.format(\"vcl/prototypes/%s\",uri.substring(i+l));}else{}\nreturn r;}});Method.override(FormContainer.prototype,{getBaseUri:function(){var r=this.inherited(arguments);if(r.indexOf(\"ws/\")===0){r=r.split(\"/\");r.shift();r.shift();r.unshift(\"home\");r=r.join(\"/\");}\nreturn r;}});}());$([\"App.v1.console\"],{title:\"Code\",icon:\"images/favicon.ico\",handlers:handlers},[$i(\"client\",{formUri:\"./Main<>\"})]);");
define("text!vcl-comps/App.js", "$([],{},[]);");
define("text!vcl/prototypes/App.v1.js", "\"util/HtmlElement, util/Fullscreen, vcl/ui/Element, vcl/ui/FormContainer\";var Fullscreen=require(\"util/Fullscreen\");var HtmlElement=require(\"util/HtmlElement\");var Element=require(\"vcl/ui/Element\");var FormContainer=require(\"vcl/ui/FormContainer\");$([\"./App.openform.toast\"],{onDispatchChildEvent:function(component,name,evt,f,args){if(name===\"touchstart\"){if(!Fullscreen.hasRequested()){Fullscreen.request(document.documentElement);}}\nreturn this.inherited(arguments);},onGetState:function(){var scope=this.getScope();var form=scope.client._form;if(form){return form.applyVar(\"App.getState\",[],\"silent\");}\nreturn{restore:function(){alert(\"?\");}};},onSetState:function(state){state&&state.restore&&state.restore(state);}},[$i(\"window\",[$(\"vcl/ui/FormContainer\",\"client\",{formUri:\"./ui/forms/Portal<>\"}),])]);");
define("text!vcl/prototypes/App.console.js", "\"use override\";var override=require(\"override\");var Event=require(\"util/Event\");override(require(\"vcl/Component\").prototype,\"print\",function(inherited){return function(){var console=this.down(\"vcl/ui/Console#console\");if(console&&!console.vars(\"skip-print\")){return console.print.apply(console,arguments);}\nreturn inherited.apply(this,arguments);};});[\"\",{onLoad:function(){return this.inherited(arguments);}},[[\"vcl/Action\",(\"toggle-console\"),{hotkey:`keyup:Ctrl+Escape|keydown:Ctrl+Escape|keyup:Ctrl+Shift+D|keydown:Ctrl+Shift+D|keyup:Alt+Shift+X|keydown:Alt+Shift+X|keyup:MetaCtrl+192`,onLoad(){this.readStorage(\"visible\",(visible)=>eval(visible)&&this.execute({}));},onExecute(evt){var scope=this.scope();var focused;if(evt.type===\"keydown\"){focused=require(\"vcl/Control\").focused;if(focused!==scope.console.getScope().console){this.setVar(\"focused\",focused);}}else{if(!scope.console.isVisible()){scope.console.show();scope['align-enabled'].setState(true);}else{scope['align-enabled'].setState(false);scope.console.hide();focused=this.removeVar(\"focused\");if(focused&&focused!==scope.console){this.setTimeout(\"focus\",function(){focused.setFocus();},250);}}}\nthis.writeStorage(\"visible\",scope.console.isVisible());return this.inherited(arguments);}}],[\"vcl/Action\",(\"align-enabled\"),{enabled:\"state\",state:false}],[\"vcl/Action\",(\"align-size-vertically\"),{hotkey:\"keyup:Ctrl+Alt+Down|keyup:Ctrl+Alt+Up\",enabled:\"parent\",parent:\"align-enabled\",on(evt){var console=this.scope().console;var delta=evt.keyCode===Event.keys.KEY_UP_ARROW?100:-100;var height=console.getHeight()+delta;if(console._align!==\"bottom\"&&console._align!==\"top\"){console.setAlign(delta===-100?\"bottom\":\"top\");height=console.vars(\"height\")||200;}else{if(height<100){height=100;}else{var cs=console._parent.getComputedStyle();if(height>parseInt(cs.height,10)){height=parseInt(cs.height,10);}}}\nconsole.setHeight(height);console.vars(\"height\",height);if((console=console.qs(\"#console\")).hasClass(\"no-time\")){console.removeClass(\"no-time\");}}}],[\"vcl/Action\",(\"align-size-horizontally\"),{hotkey:\"Ctrl+Alt+Left|Ctrl+Alt+Right\",enabled:\"parent\",parent:\"align-enabled\",on(evt){var console=this.scope().console,cons=console.qs(\"#console\");var delta=evt.keyCode===Event.keys.KEY_RIGHT_ARROW?100:-100;var width=console.getWidth()+delta;if(console._align!==\"left\"&&console._align!==\"right\"){console.setAlign(delta===-100?\"left\":\"right\");width=console.vars(\"width\")||375;}else{if(width<100){width=100;}else{var cs=console._parent.getComputedStyle();if(width>parseInt(cs.width,10)-175){width=parseInt(cs.width,10)-175;}}}\nconsole.setWidth(width);console.vars(\"width\",width);if(!(console=console.qs(\"#console\")).hasClass(\"no-time\")){console.addClass(\"no-time\");}}}],[[\"ui/forms/util/Console\"],\"console\",{align:\"bottom\",height:250,visible:false,vars:\"parent: window;\"}]]];");
define("text!vcl/prototypes/ui/Form.js", "\"vcl/ui/Button\";$(\"vcl/ui/Form\",{tabIndex:1,onReceiveParams:function(params){var scope=this.getScope();if(params.canClose!==undefined){scope.form_close.setEnabled(params.canClose===true);scope.form_close.setVisible(params.canClose===true);}\nreturn this.inherited(arguments);}},[$(\"vcl/Action\",\"form_close\",{content:\"Close\",left:96,top:32}),$(\"vcl/Action\",\"url_state_push\",{left:96,top:72}),$(\"vcl/Action\",\"url_state_pop\",{left:96,top:112})]);");
define("text!vcl/prototypes/ui/controls/SizeHandle.js", "\"vcl/Dragger\";$(\"vcl/ui/Element\",{draggable:true,css:{position:\"absolute\",top:\"0\",right:\"0\",zIndex:\"999999999999\",\"background-repeat\":\"no-repeat\",\"background-position\":\"center\",\"&.horizontal\":{\"background-image\":\"url(/shared/vcl/images/statusbarResizerHorizontal.png)\",cursor:\"ew-resize\",height:\"24px\",width:\"16px\"},\"&.vertical\":{\"background-image\":\"url(/shared/vcl/images/statusbarResizerVertical.png)\",cursor:\"ns-resize\",height:\"8px\",\"margin-top\":\"7px\",width:\"20px\"}},onLoad:function(){var control=this.getVar(\"control\");if(!(control instanceof require(\"vcl/Control\"))){var scope=this.getScope();this.setVar(\"control\",scope[control]||this);}else{console.log(\"skipped\");}\nreturn this.inherited(arguments);},onDraggerNeeded:function(){var control=this.getVar(\"control\");var dragger=new(require(\"vcl/Dragger\"))(this);var horizontal=this.hasClass(\"horizontal\");dragger.setCursor(horizontal?\"ew-resize\":\"ns-resize\");dragger.override({updateHandles:function(evt){if(horizontal===true){if(!control.getVisible()){control.setVisible(true);control.setWidth(0);}\ncontrol.setWidth(control.getWidth()+(evt.clientX-this._sx));}else{if(!control.getVisible()){control.setVisible(true);control.setHeight(0);}\ncontrol.setHeight(control.getHeight()-(evt.clientY-this._sy));}\nthis._sx=evt.clientX;this._sy=evt.clientY;}});return dragger;}});");
define("text!vcl/prototypes/App.toast.js", "$([],{onToast:function(options){var Element=require(\"vcl/ui/Element\");var scope=this.getScope();var elem=new Element(this);var timeout=options.hasOwnProperty(\"timeout\")?options.timeout:1500;var content=options.content||\"No toast content\";var classes=options.classes||\"fade\";if(options.title!==undefined){content=String.format(\"<b>%s</b><div>%s</div>\",options.title,content);}\nelem.setContent(content);elem.setParent(scope.toasts);elem.addClasses(classes);elem.update(function(){elem.addClass(\"appear\");});var controller={element:elem,remove:function(timeout_){elem.setTimeout(\"disappear\",function(){var h=elem.on(\"transitionend\",function(){elem.un(h);elem.setParent(null);});elem.replaceClass(\"appear\",\"disappear\");},timeout_!==undefined?timeout_:timeout);}};if(timeout){controller.remove();}\nreturn controller;}},[$(\"vcl/ui/Panel\",\"toasts\",{parent:\"window\",autoSize:\"both\",autoPosition:\"top-left-bottom-right\",css:{\".right-half-size-switch\":{height:\"15px\",width:\"20px\",display:\"inline-block\",float:\"right\",transform:\"scale3d(0.5, 0.5, 1) translate3d(0, -9px, 0)\"},right:\"0\",left:\"0\",bottom:\"40px\",\"z-index\":\"20000\",font:\"10pt arial\",\"pointer-events\":\"none\",\".{./Element}\":{\"pointer-events\":\"all\",\"a\":{\"text-decoration\":\"underline\",cursor:\"pointer\"},\"background-color\":\"white\",opacity:\"0.75\",color:\"black\",padding:\"8px\",\"padding-bottom\":\"7px\",margin:\"4px\",\"float\":\"right\",\"clear\":\"both\",\"&.box-shadow\":{\"box-shadow\":\"0 1px 5px rgba(0,0,0,0.65)\",\"border-radius\":\"4px\"},\"&.no-clear\":\"clear: none;\",\"&.fade\":{opacity:\"0\",transition:\"opacity 1s ease\",},\"&.appear\":{opacity:\"1\"},\"&.disappear\":{},\"&:hover\":{opacity:\"1\"},\"&.loading-right\":{\"background-image\":\"url(/shared/vcl/images/loading.gif)\",\"background-position\":\"95% center\",\"background-repeat\":\"no-repeat\",\"padding-right\":\"32px\"},\"&.padding-right-20px\":{\"padding-right\":\"20px\"},}}})]);");
define("text!vcl/prototypes/ui/controls/Toolbar.js", "$(\"vcl/ui/Panel\",{align:\"top\",height:23,css:{\"background-color\":\"#f0f0f0\",\"border-bottom\":\"1px solid silver\",overflow:\"hidden\"}});");
define("text!vcl-comps/devtools/Main.js", "\"js/Method, vcl/ui/Ace, vcl/ui/Tab, vcl/ui/Panel, vcl/ui/Bar, vcl/ui/FormContainer, util/HotkeyManager, util/net/Url\";var Ace=require(\"vcl/ui/Ace\");var Tab=require(\"vcl/ui/Tab\");var Control=require(\"vcl/Control\");var Method=require(\"js/Method\");var HotkeyManager=require(\"util/HotkeyManager\");var Url=require(\"util/net/Url\");var FormContainer=require(\"vcl/ui/FormContainer\");function title(){var url=app.vars(\"url\");return js.sf(\"%s\",url.getParamValue(\"title\")||url.getParamValue(\"\")||\"cavalion-code\");}\nfunction title_css(){var url=app.vars(\"url\");var colors=url.getParamValue(\"title-colors\");colors=(colors&&colors.split(\"|\"))||[\"rgb(56, 121, 217)\",\"white\"];return{\"\":\"text-align:center;float:right;min-width:200px;line-height:26px;\",\"&:not(.custom-colors)\":js.sf(\"background-color:%s;color:%s;\",colors[0],colors[1]),\"&.arcadis\":\"background-color:orange;color:black;\",\"&.cavalion\":\"background-color:rgb(48,61,80);color:white;\",\"&.veldapps\":\"background-color:limegreen;color:white;\",\"&.eae\":\"background-color:rgb(14,32,77);color:white;\",};}\nfunction replaceChars(uri){return uri.replace(/\\//g,\".\");}\nfunction forceUpdate(control){var ControlUpdater=require(\"vcl/ControlUpdater\");(function loop(c){ControlUpdater.queue(c);c._controls&&c._controls.forEach(loop);}(control));}\nfunction focusSidebar(ws,sidebar){var tab=ws.qs(\"#left-sidebar < vcl/ui/Tab:selected\");if(tab&&tab._control){var input=tab._control.qs(\"< vcl/ui/Input\");if(input){if(!input.isFocused()){input.setFocus();}else{ws.down('*:selected #editor-setfocus').execute({},ws);}}else{var console=tab._control.qs(\"< vcl/ui/Console\");if(console)console.setFocus();}}}\n(function(styles){var node=styles[0];var parent=node.parentNode;parent.removeChild(node);parent.appendChild(node);}(Array.from(document.querySelectorAll(\"style\"))));[[\"ui/Form\"],{css:{\".{./Panel}#editors\":\"background-color: silver;\",\".tabs-hidden\":\"height:0;padding:0;border:0;\",\"#left-sidebar-tabs\":{\".{Tab}\":\"border-top-left-radius:5px; border-top-right-radius:5px;\",\".{Tab}.selected\":\"padding-left:8px;\"},\"#editors-tabs\":{\".{Tab}\":\"border-top-left-radius:5px; border-top-right-radius:5px;\",\".{Tab}.selected\":\"padding-left:8px;\"},\"#workspaces-tabs\":{\"\":\"background-color:white;\",\".{Tab}\":\"border-bottom-left-radius:5px; border-bottom-right-radius:5px;\",\".{Tab}.selected\":\"padding-left:8px;\"},\"#editors-tabs:focus\":{\"\":\"transition: background-color ease-in 0.2s; background-color: rgba(244, 253, 255, 0.94);\",\".selected\":\"border:1px solid rgb(57,121,204); background-color: rgb(57,121,204); color: white;\",\".menu\":\"color: white;\"}},onLoad(){var scope=this.scope();var me=this;function createWorkspaces(workspaces){workspaces.forEach(function(workspace){scope[\"workspace-needed\"].execute({sender:me,workspace:workspace,selected:workspace.selected});});}\nvar url=app.vars(\"url\");var workspaces=url.getParamValue(\"workspaces\");var title=url.getParamValue(\"title\");if(title){this.app()['@properties'].title=title;this.app().setTitle(title);}\nif(this.up(\"devtools/Main<>\")===null&&workspaces){createWorkspaces(workspaces.split(\",\").map(_=>({name:_})));}else{createWorkspaces(this.vars(\"default-workspaces\")||[]);}\nthis.readStorage(\"state\",function(state){if(state!==undefined){var index=state.workspace;var tab=scope['workspaces-tabs'].getControl(index);tab&&tab.setSelected(true);}});this.on(\"state-dirty\",function(){me.setTimeout(\"saveState\",function(){me.writeStorage(\"state\",{workspace:scope['workspaces-tabs'].getSelectedControl(1).getIndex()});},200);});var console_scope=this.app().scope().console.scope();console_scope.toolbar&&console_scope.toolbar.setVisible(false);console_scope.size_handle&&console_scope.size_handle.setParent(scope['workspaces-tabs']);var version=document.qs(\"html head script\").text.split(\"\\n\")[1].split(\"\\\"\")[3]||\"from source\";this.app().print(\"running \"+version,this);return this.inherited(arguments);},onActivate(){var shortcuts={\"Ctrl+Alt+F1\":\"editor-move-to-front\",\"Ctrl+N\":\"editor-new\",\"Alt+Ctrl+N\":\"editor-new\",\"Shift+Ctrl+40\":\"editors-next\",\"Shift+Ctrl+38\":\"editors-previous\",\"Shift+Ctrl+39\":\"editor-next\",\"Shift+Ctrl+37\":\"editor-previous\",\"Shift+Ctrl+186\":\"editors-next\",\"Shift+Ctrl+189\":\"editors-previous\",\"Shift+Ctrl+221\":\"editor-next\",\"Shift+Ctrl+219\":\"editor-previous\",\"Ctrl+Tab\":\"editor-next\",\"Shift+Ctrl+Tab\":\"editor-previous\",\"Shift+Ctrl+Meta+219\":\"editor-move-left\",\"Shift+Ctrl+Meta+221\":\"editor-move-right\",\"Ctrl+W\":\"editor-close\",\"Shift+Ctrl+W\":\"editors-close-all\",\"Alt+Shift+Ctrl+W\":\"editors-close-all\",\"Escape\":\"editor-setfocus\"};var me=this;function create_callback(hotkey,action){return function(evt,type){evt.preventDefault();me.qsa(\"devtools/Workspace<>:root:selected:visible #\"+action).execute(evt);};}\nfunction create_callback_sidebar(hotkey,index){return function(evt,type){evt.preventDefault();var ws=me.down(\"devtools/Workspace<>:root:selected\");var sidebar=ws.down(\"#left-sidebar\");if(!sidebar.isVisible()){sidebar.show();}\nsidebar.update(function(){var tabs=me.down(\"devtools/Workspace<>:root:selected #left-sidebar-tabs\");var tab=tabs._controls.filter(_=>_ instanceof Control)[index];tab.setSelected(true);tab.update(function(){focusSidebar(ws,sidebar);});});};}\nfunction create_callback_activateWS(hotkey,index){return function(evt,type){evt.preventDefault();var tab=me.scope()['workspaces-tabs'].qsa(\"< vcl/ui/Tab\")[index];tab.setSelected(true);try{if((tab=tab._control.qs(\"#left-sidebar-tabs < vcl/ui/Tab:selected\"))){var input=tab._control.qs(\"vcl/ui/Input\");if(!input.isFocused()){input.setFocus();}else{console.log(\"focus editor\");me.down('*:selected #editor-setfocus').execute(evt,me);}}}catch(e){console.warn(e.message);}};}\nfor(var k in shortcuts){HotkeyManager.register(k,{type:\"keydown\",callback:create_callback(k,shortcuts[k])});}\nfunction toggleSidebar(evt){var ws=me.qs(\"devtools/Workspace<>:root:selected\");var sidebar=ws.qs(\"#left-sidebar\");if(sidebar.isVisible()){sidebar.hide();}else{sidebar.show();sidebar.update(function(){focusSidebar(ws,sidebar);});}}\nHotkeyManager.register(\"Shift+Meta+48\",{type:\"keydown\",callback:toggleSidebar});HotkeyManager.register(\"Shift+Meta+E\",{type:\"keydown\",callback:toggleSidebar});HotkeyManager.register(\"Shift+Ctrl+Z\",{type:\"keydown\",callback:function(){me.updateChildren(true,true);}});for(var i=1,hotkey;i<=9;++i){hotkey=String.format(\"Meta+%d\",i+48);HotkeyManager.register(hotkey,{type:\"keydown\",callback:create_callback_activateWS(hotkey,i-1)});hotkey=String.format(\"Ctrl+Alt+%d\",i+48);HotkeyManager.register(hotkey,{type:\"keydown\",callback:create_callback_activateWS(hotkey,i-1)});hotkey=String.format(\"Meta+Alt+%d\",i+48);HotkeyManager.register(hotkey,{type:\"keydown\",callback:create_callback_sidebar(hotkey,i-1)});}\nvar ctrlctrl=this.scope(\"ctrlctrl\");(function(focused){HotkeyManager.register({keyCode:17,type:\"keyup\",callback:function(evt){if(focused){if(ctrlctrl.getVisible())ctrlctrl.hide();else ctrlctrl.show();}else{focused=require(\"vcl/Control\").focused;me.setTimeout(\"ctrlctrl\",function(){focused=null;},250);}}});}());},onDeactivate(){}},[[[\"devtools/DragDropHandler<dropbox>\"]],[[\"devtools/TabFactory\"],\"workspaces-new\",{vars:{parents:{tab:\"workspaces-tabs\",container:\"@owner\",owner:\"@owner\"}},onExecute:function(evt){if(!evt.hasOwnProperty(\"formUri\")){evt.formUri=evt.workspace.formUri||String.format(\"devtools/Workspace<%s>\",replaceChars(evt.workspace.name||\"\"));}\nevt.params=evt.workspace;var tab=this.inherited(arguments);tab.setVar(\"workspace\",evt.workspace);tab.setText(evt.workspace.name);return tab;}}],[(\"vcl/Action\"),\"hide-workspace-tabs\",{onExecute(){var twt=this.ud(\"#toggle-workspace-tabs\");twt._tag=!true;twt.execute();}}],[(\"vcl/Action\"),\"show-workspace-tabs\",{onExecute(){var twt=this.ud(\"#toggle-workspace-tabs\");twt._tag=!false;twt.execute();}}],[(\"vcl/Action\"),\"toggle-workspace-tabs\",{hotkey:\"Ctrl+F12\",onExecute:function(){var visible=this._tag;var focused=require(\"vcl/Control\").focused;var current=this.vars([\"editors-tabs:focused\"]);var before=this.vars(\"before\")||0;var now=Date.now();var tabs={editors:this.app().qsa(\"devtools/Workspace<>:root vcl/ui/Tabs#editors-tabs\"),bottom:this.app().qsa(\"devtools/Workspace<>:root vcl/ui/Tabs#bottom-tabs\"),left_sidebar:this.app().qsa(\"devtools/Workspace<>:root vcl/ui/Tabs#left-sidebar-tabs\")};if(now-before<250){current=focused&&focused.udr(\"vcl/ui/Tabs#editors-tabs\");if(!visible){tabs.editors=tabs.editors.filter(tabs=>tabs!==current);}else{tabs.editors=tabs.editors.filter(tabs=>tabs===current);}}\nvar hide=(tab)=>!tab.hasClass(\"tabs-hidden\")&&tab.addClass(\"tabs-hidden\");var show=(tab)=>tab.removeClass(\"tabs-hidden\");if(visible===true){tabs.editors.map(show);tabs.bottom.map(show);tabs.left_sidebar.map(show);}else{tabs.editors.map(hide);tabs.bottom.map(hide);tabs.left_sidebar.map(hide);}\nthis.vars(\"before\",now);this._tag=!this._tag;}}],[(\"vcl/Action\"),\"toggle-workspaces-tabs\",{hotkey:\"Ctrl+Alt+F12\",onExecute:function(){var tabs=this.app().down(\"devtools/Main<> #workspaces-tabs\");tabs.setVisible(!tabs.getVisible());}}],[(\"vcl/Action\"),\"workspace-issues-new\",{hotkey:\"Shift+Ctrl+73\",onExecute(){var ws=app.down(\"devtools/Workspace<>:root:selected\");var repo=ws.vars([\"workspace.github-repo\"])||js.sf(\"relluf/cavalion-%s\",ws.vars([\"workspace.name\"]));window.open(js.sf(\"https://github.com/%s/issues/new\",repo),\"\",\"menubar=no\");}}],[(\"vcl/Action\"),\"workspace-prompt-new\",{hotkey:\"Shift+122\",onExecute:function(evt){var n=this.udown(\"#workspaces-tabs\")._controls.length,me=this;this.app().prompt(\"#workspace-needed execute\",\"ws\"+n,function(res){if(res){me.up().qs(\"#workspace-needed\").execute(res).setSelected(true);}})}}],[(\"vcl/Action\"),\"workspace-prompt-new-resource\",{hotkey:\"Shift+121\",onExecute:function(evt){var me=this,parent=this.up().qsa(\"devtools/Editor<>:root:visible\").pop();parent=parent?js.up(parent.vars([\"resource.uri\"])):\"tmp\";var editorNeeded=this.app().down(\"devtools/Workspace<>:root:selected #editor-needed\");this.app().prompt(\"#editor-needed execute\",parent+\"/Resource-\"+Math.random().toString(36).substring(2,15),function(value){if(value!==null){editorNeeded.execute(value).setSelected(true);}});}}],[(\"vcl/Action\"),\"workspace-find\",{hotkey:\"Alt+F\",onExecute:function(){var ws=this.up().down(\"devtools/Workspace<>:root:selected\");var sidebar=ws.down(\"#left-sidebar\");sidebar.show();sidebar.update(function(){focusSidebar(ws,sidebar);});}}],[(\"vcl/Action\"),\"workspace-needed\",{onExecute:function(evt){if(evt instanceof Array){var me=this;return evt.forEach(function(ws){me.execute(ws);});}\nif(typeof evt===\"string\"){evt={workspace:{name:evt}};}\nvar scope=this.getScope();var tabs=scope['workspaces-tabs'].getControls();var tab=tabs.find(function(tab){return tab.getVar(\"workspace.name\")===evt.workspace.name;});if(!tab){tab=scope['workspaces-new'].execute(evt);}else{tab.setSelected(true);}\nreturn tab;}}],[(\"vcl/Action\"),\"workspace-activate\",{onExecute:function(evt){var tab,tabs=this.getScope()['workspaces-tabs'];if((tab=tabs.getControl(evt.keyCode-49))!==null){evt.preventDefault();tab.setSelected(true);tab.update(()=>tab.scrollIntoView());try{tab=tab._control.qs(\"#left-sidebar-tabs < vcl/ui/Tab:selected\");}catch(e){console.warn(e.message);}}}}],[(\"vcl/Action\"),\"workspace-left-sidebar-tabs::next-previous\",{hotkey:\"Ctrl+32|Ctrl+Shift+32\",onExecute:function(evt){var ws=this.up().down(\"devtools/Workspace<>:root:selected\");var tabs=ws.down(\"#left-sidebar-tabs\");var sidebar=ws.down(\"#left-sidebar\");if(!sidebar.isVisible()){sidebar.show();sidebar.update(function(){focusSidebar(ws,sidebar);});}else{tabs[\"select\"+(evt.shiftKey?\"Previous\":\"Next\")]();}\nevt.preventDefault();}}],[(\"vcl/Action\"),\"workspace-move-left\",{hotkey:\"Ctrl+Alt+Meta+219\",onExecute:function(){var tab=this._owner.qs(\"vcl/ui/Tab:selected:childOf(workspaces-tabs)\");var index=tab.getIndex();if(index>0){tab.setIndex(index-1);}}}],[(\"vcl/Action\"),\"workspace-move-right\",{hotkey:\"Ctrl+Alt+Meta+221\",onExecute:function(){var tab=this._owner.qs(\"vcl/ui/Tab:selected:childOf(workspaces-tabs)\");var index=tab.getIndex();tab.setIndex(index+1);}}],[(\"vcl/Action\"),\"workspaces-tabs::next-previous\",{hotkey:\"Ctrl+Alt+219|Ctrl+Alt+221|Shift+Meta+219|Shift+Meta+221\",onExecute:function(evt){var method=evt.keyCode===219?\"Previous\":\"Next\";this.scope(\"workspaces-tabs\")[\"select\"+method]();evt.preventDefault();}}],[(\"vcl/Action\"),\"workspaces-tabs-dblclick\",{hotkey:\"Ctrl+Alt+187\",onExecute:function(){this.scope(\"workspaces-tabs\").ondblclick({});}}],[(\"vcl/Action\"),\"open_form\",{left:96,onExecute:function onExecute(uri,options){var scope=this.scope();var owner=this._owner;var selectedTab=scope['workspaces-tabs'].getSelectedControl(1);var container=new FormContainer(owner);var tab=new Tab(owner);tab.setText(uri);if(options.closeable!==false){tab.addClass(\"closeable\");}\ntab.setText(\"&nbsp;<img src='/shared/vcl/images/loading.gif' align='absmiddle'>\"+(options.text||\"&nbsp;\"));container.on(\"formload\",function(){tab.setText(uri);});tab.setControl(container);tab.setParent(scope['workspaces-tabs']);if(selectedTab!==null){}\ntab.setSelected(options.selected!==false);tab.setOnCloseClick(function(){container.getForm().close();});container.setVisible(false);container.setFormUri(uri);container.setAlign(\"client\");container.setParent(scope['@owner']);container.setOnFormLoadError(function(){alert(\"Could not load form \"+container.getFormUri());tab.destroy();container.destroy();form=null;tab=null;container=null;return false;});container.setOnFormClose(function(){this.getForm().destroy();this.destroy();tab.destroy();form=null;tab=null;container=null;});container.setOnGetFormParams(options.onGetFormParams||null);container.setFormParams(options.params||null);container.setVisible(options.selected!==false);if(options.forceLoad!==false){container.forceLoad();}\ntab._update();return tab;},top:232}],[(\"vcl/Action\"),\"F5-blocker\",{hotkey:\"F5|MetaCtrl+R\",onExecute:function(evt){evt.preventDefault();}}],[(\"vcl/ui/Tabs\"),\"workspaces-tabs\",{align:\"bottom\",classes:\"bottom\",onDblClick:function(evt){this.udown(\"#workspace-prompt-new\").execute(evt);},onChange:function(){this._owner.emit(\"state-dirty\");}},[[(\"vcl/ui/Element\"),\"title\",{index:0,element:\"span\",css:title_css(),content:js.sf(\"&nbsp; <b>%s<b> <i class='fa fa-caret-down'></i>  &nbsp;\",title())}]]]]];");
define("text!vcl-comps/devtools/TabFactory.js", "\"vcl/ui/FormContainer, vcl/ui/Tab\";var Tab=require(\"vcl/ui/Tab\");var FormContainer=require(\"vcl/ui/FormContainer\");function Tab_oncloseclick(){this._control._form&&this._control._form.destroy();this.destroy();}\nfunction FormContainer_dispatchChildEvent(component,name,evt,f,args){if(name.indexOf(\"form\")===0&&name===\"formclose\"){component._owner.destroy();}\nreturn this.inherited(arguments);}\n$(\"vcl/Action\",{vars:{closeable:\"default for Tab.closeable if not specified in params\",parents:{container:\"reference to parent of to be created FormContainers\",tab:\"\"}},onExecute:function(evt){var scope=this.scope();var parents=js.mixIn(evt.parents||this.getVar(\"parents\"));var closeable=evt.closeable||this.getVar(\"closeable\");var formUri=evt.formUri||this.getVar(\"formUri\");for(var k in parents){if(typeof parents[k]===\"string\"){parents[k]=scope[parents[k]];}}\nvar tab=new Tab(evt.owner||scope['@owner']);var fc=new FormContainer(tab);tab.setCloseable(closeable);tab.setControl(fc);tab.setParent(parents.tab);tab.setOnCloseClick(Tab_oncloseclick);fc._onDispatchChildEvent=FormContainer_dispatchChildEvent;fc.setVisible(false);fc.setParent(parents.container);fc.setFormUri(formUri);evt.formParams&&fc.setFormParams(evt.formParams);evt.selected&&tab.setSelected(evt.selected);return tab;}});");
define("text!vcl-comps/devtools/DragDropHandler.js", "function handleFile(file,r){let reader=new FileReader();reader.onloadend=function(){var result=reader.result;r.readerResult=result;};if(r.type.startsWith(\"image/\")){reader.readAsDataURL(file);}else{reader.readAsText(file);}\nreturn file;}\nfunction copy(obj,r){r=r||{};for(var k in obj){var v=obj[k];if(typeof v===\"object\"){if(typeof v.length===\"number\"){v=copy(v,[]);}else{v=copy(v);}}\nif(typeof v!==\"function\"){r[k]=v;}else if(k===\"getAsString\"){obj.getAsString(function(value){r.strValue=value;});}else if(k===\"getAsFile\"){r.fileValue=handleFile(obj.getAsFile(),r);}else{r[k]=function(){};}}\nreturn r;}\n[\"vcl/ui/Panel\",{onLoad:function(){this.setParentNode(document.body);var me=this,listeners;var dropped=this.vars(\"dropped\",false,[]);this.vars(\"listeners\",listeners={dragover:function(evt){evt.preventDefault();me.setVisible(true);},dragleave:function(evt){evt.preventDefault();me.setVisible(false);},drop:function(evt){var dataTransfer=copy(evt.dataTransfer);dropped.push(dataTransfer);me.emit(\"dropped\",[dataTransfer,dropped]);evt.preventDefault();me.setVisible(false);}});document.addEventListener(\"dragover\",listeners.dragover);document.addEventListener(\"dragleave\",listeners.dragleave);document.addEventListener(\"drop\",listeners.drop);},onDestroy:function(){var listeners=this.vars(\"listeners\");document.removeEventListener(\"dragover\",listeners.dragover);document.removeEventListener(\"dragleave\",listeners.dragleave);document.removeEventListener(\"drop\",listeners.drop);},align:\"client\",css:\"background-color:rgba(45,45,45,0.8);z-index:9999999999; color:white;padding:64px; font-family:\\\"Lucida Grande\\\", Arial, sans-serif;\",content:locale(\"DragDropHandler.dropHereMessage\")+\" [\"+Date.now()+\"]\",visible:false}];");
define("text!vcl-comps/devtools/CtrlCtrl.js", "$(\"vcl/ui/Form\",{activeControl:\"input\",autoSize:\"both\",autoPosition:\"top-left-bottom-right\",css:{\"position\":\"absolute\",\"background-color\":\"rgba(255, 255, 255, 0.85)\",\"top\":\"120px\",\"width\":\"50%\",\"height\":\"64px\",\"margin-left\":\"25%\",\"margin-right\":\"25%\",\"z-index\":\"99999\",padding:\"8px\",\"box-shadow\":\"0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 3px 0 rgba(0, 0, 0, 0.19)\",\"input\":{background:\"transparent\",border:\"none\",width:\"100%\",height:\"50px\",\"font-size\":\"16pt\",padding:\"3px 12px\"}},onActivate:function(){this.setVar(\"focused\",require(\"vcl/Control\").focused);},onDeactivate:function(){var control=this.getVar(\"focused\");control&&control.setFocus();},onLoad:function(){this.setParentNode(document.body);}},[$(\"vcl/ui/Input\",\"input\",{onKeyDown:function(evt){if(evt.keyCode===27){this._owner.hide();}},onBlur:function(){var me=this;this.setTimeout(function(){me._owner.hide();},200);}})]);");
define("text!vcl-comps/devtools/Workspace.js", "\"use vcl/ui/Ace, vcl/ui/FormContainer, vcl/ui/Tab, ace/range, locale\";var Tab={render:function(){var text=this.getVar(\"resource.uri\")||\"New\";this.getNode().title=text;var html=String.format(\"%H\",text.split(\"/\").pop());if(0&&html.charAt(0)===\".\"){text=text.split(\"/\");text.pop();html=text.pop()+\"/\"+html;}\nif(this.getVar(\"modified\")){html=\"* \"+html;}\nvar ace=this.qs(\"vcl/ui/Ace\");if(ace){html+=String.format(\" <span class='hashcode'>[%s]</span>\",ace.hashCode());}\nthis._nodes.text.innerHTML=html;},show:(tab)=>tab.removeClass(\"tabs-hidden\"),hide:(tab)=>!tab.hasClass(\"tabs-hidden\")&&tab.addClass(\"tabs-hidden\"),isHidden:(tab)=>tab.hasClass(\"tabs-hidden\")};var Utils={getState:function(scope){var tabs=scope[\"editors-tabs\"].getControls();return{'left-sidebar.visible':scope['left-sidebar'].getVisible(),editors:tabs.filter(function(tab){var ace=tab.qsa(\"devtools/Editor<> #ace\")[0];var resource=tab.getVar(\"resource\")||{},r;return resource&&resource.uri;}).map(function(tab){var resource=tab.vars(\"resource\");return{selected:tab.isSelected(),resource:{uri:resource.uri,type:resource.type,contentType:resource.contentType}};})};},setState:function(state,scope){var Range=require(\"ace/range\").Range;var workspace=scope['@owner'];if(state){state.editors&&state.editors.forEach(function(state){var _state=js.mixIn({},state);var tab=scope[\"editor-needed\"].execute(js.mixIn(state,{dontBringToFront:true}));tab.setVar(\".state\",_state);});scope['left-sidebar'].setVisible(state['left-sidebar.visible']!==false);}}};[[\"ui/Form\"],{onLoad:function(){var scope=this.scope();var workspace=this.vars([\"workspace\"]);this.readStorage(\"state\",function(value){value=value||{workspace:0};Utils.setState(js.mixIn(workspace.state||{},value),scope);});this.on(\"state-dirty\",function(){var workspace=scope['@owner'];workspace.setTimeout(\"saveState\",function(){workspace.writeStorage(\"state\",Utils.getState(workspace.getScope()));},200);});scope['left-sidebar'].override(\"visibleChanged\",function(){this._owner.emit(\"state-dirty\");return this.inherited(arguments);});this.open=function(evt){if(typeof evt===\"string\"){evt={resource:{uri:evt},selected:true};}\nscope['editor-needed'].execute(evt);};return this.inherited(arguments);},onDispatchChildEvent:function(component,name,evt,f,args){var Tabs=require(\"vcl/ui/Tabs\"),Tab=require(\"vcl/ui/Tab\");if(name===\"click\"){if(component instanceof Tabs){this.vars(\"editors-tabs:focused\",component);}else if(component instanceof Tab){this.vars(\"editors-tabs:focused\",component._parent);}}},onActivate:function(){this.getApp().setTimeout({name:\"devtools/Workspace<>.activate\",f:function(me){me.qsa([\"vcl/ui/Tab[uri=devtools/Workspace][selected=true]\",\"vcl/ui/Ace\"].join(\" \")).focus();},ms:200,args:[this]});this.setSelected(true);},onDeactivate:function(){this.setSelected(false);}},[[[\"devtools/TabFactory\"],(\"editor-factory\"),{vars:{closeable:true,formUri:\"devtools/Editor<js>\",parents:{container:\"editors\",tab:\"editors-tabs\"}},onExecute:function(evt){var tab=this.inherited(arguments);var owner=tab.getOwner();tab.render=Tab.render;tab._control.once(\"formloaded\",function(){tab.render();this._form.setName(tab.getVar(\"resource.uri\"));});tab.set({onMenuClick:function(evt){return this.qsa(\"#menu-open\").execute(evt);}});return tab;}}],[\"vcl/Action\",(\"editors-next\"),{onExecute:function(){var tabs=this.up().qsa(\"#editors-tabs:visible\");var focused=this.up().vars(\"editors-tabs:focused\");if(focused&&!focused.isFocused()){}else if(tabs.length){var index=tabs.indexOf(focused)+1;if(index>=tabs.length)index=0;focused=this.up().vars(\"editors-tabs:focused\",tabs[index]);}\nTab.show(focused);focused.setFocus();}}],[\"vcl/Action\",(\"editors-previous\"),{onExecute:function(){var tabs=this.up().qsa(\"#editors-tabs:visible\");var focused=this.up().vars(\"editors-tabs:focused\");if(focused&&!focused.isFocused()){}else if(tabs.length){var index=tabs.indexOf(focused)-1;if(index<0)index=tabs.length-1;focused=this.up().vars(\"editors-tabs:focused\",tabs[index]);}\nTab.show(focused);focused.setFocus();}}],[\"vcl/Action\",(\"editors-close-all\"),{onExecute:function(evt){var tabs=this.vars([\"editors-tabs:focused\"])||this.udown(\"#editors-tabs\");var selected=tabs.getSelectedControl(1);tabs._controls.filter(_=>_!==selected).filter(_=>evt.altKey===true||_.vars([\"resource.type\"])===\"File\").forEach(function(tab){tabs.print(\"closing\",tab);tab._control.destroy();tab._control=null;tab.destroy();});}}],[\"vcl/Action\",(\"editor-new\"),{onExecute:function(evt){this.scope(\"editor-factory\").execute(evt).setSelected(true);}}],[\"vcl/Action\",(\"editor-needed\"),{onExecute:function(evt){var scope=this.scope(),tab;if(typeof evt===\"string\"){evt={resource:{uri:evt,type:evt.startsWith(\"folder:\")?\"Folder\":\"File\"}};}\nif(!evt.resource){evt.resource={uri:\"\"}};if(!evt.parents){var tabs=scope['editors-tabs'].getControls();tab=tabs.find(function(tab){return tab.getVar(\"resource.uri\")===evt.resource.uri;});}\nif(!tab){if(!evt.formUri){this.vars(\"devtools/Editor\")}\nif(evt.resource.contentType&&evt.resource.type!==\"Folder\"){var type=evt.resource.contentType.split(\"/\").pop();evt.editorUri=js.sf(\"devtools/Editor<%s>\",type);}\nif(evt.editorUri){evt.formUri=evt.editorUri;}\nif(!evt.formUri){var uri=(evt.resource.uri||\"\");var path=uri?uri.split(\"/\"):[];var ext=uri.indexOf(\".\")!==-1?uri.split(\".\").pop():\"\";if(evt.resource.type===\"Folder\"){evt.formUri=\"devtools/Editor<folder>\";}else if(path.indexOf(\"vcl-comps\")!==-1&&ext===\"js\"){evt.formUri=\"devtools/Editor<vcl>\";}else if(path.indexOf(\"cavalion-blocks\")!==-1&&ext===\"js\"){evt.formUri=\"devtools/Editor<blocks>\";}else if(path.length>1&&uri.indexOf(\"/var/log/\")!==-1){evt.formUri=\"devtools/Editor<var/log>\";}else if(uri.indexOf(\"ElliTrack-\")!==-1&&uri.endsWith(\".txt\")){evt.formUri=\"devtools/Editor<tsv/ElliTrack>\";}else{if(ext){evt.formUri=String.format(\"devtools/Editor<%s>\",ext);}}}\nvar on=this.vars(\"onGetEditorUri\");if(on){}\ntab=scope['editor-factory'].execute(evt,this);tab.setVar(\"resource\",evt.resource);tab.nodeNeeded();}else{if(evt.selected===true){tab.setSelected(true);}}\nif(!evt.dontBringToFront){tab.setIndex(0);}\nreturn tab;}}],[\"vcl/Action\",(\"editor-next\"),{onExecute:function(){var ws=this.up();var tabs=ws.vars(\"editors-tabs:focused\")||ws.qs(\"#editors-tabs\");if(!tabs.isVisible())tabs=ws.qs(\"#editors-tabs\");if(tabs&&!tabs.isFocused())tabs.setFocus();tabs.selectNext();}}],[\"vcl/Action\",(\"editor-previous\"),{onExecute:function(){var ws=this.up();var tabs=ws.vars(\"editors-tabs:focused\")||ws.qs(\"#editors-tabs\");if(!tabs.isVisible())tabs=ws.qs(\"#editors-tabs\");if(tabs&&!tabs.isFocused())tabs.setFocus();tabs.selectPrevious();}}],[\"vcl/Action\",(\"editor-close\"),{onExecute:function(evt){var scope=this.getScope();var selected=scope['editors-tabs'].getSelectedControl(1);if(selected){selected._control._form.close();}\nevt.preventDefault();}}],[\"vcl/Action\",(\"editor-move-to-front\"),{onExecute:function(){this._owner.qs(\"vcl/ui/Tab:selected:childOf(editors-tabs)\").setIndex(0);}}],[\"vcl/Action\",(\"editor-move-left\"),{onExecute:function(){var tab=this._owner.qs(\"vcl/ui/Tab:selected:childOf(editors-tabs)\");var index=tab.getIndex();if(index>0){tab.setIndex(index-1);}}}],[\"vcl/Action\",(\"editor-move-right\"),{onExecute:function(){var tab=this._owner.qs(\"vcl/ui/Tab:selected:childOf(editors-tabs)\");var index=tab.getIndex();tab.setIndex(index+1);}}],[\"vcl/Action\",(\"editor-setfocus\"),{onExecute:function(evt){this._owner.qs(\"vcl/ui/Tab:selected:childOf(editors-tabs) #ace\").setFocus();}}],[\"vcl/Action\",(\"editor-focus-in-navigator\"),{onExecute:function(evt){}}],[\"vcl/ui/Panel\",(\"left-sidebar\"),{align:\"left\",css:\"border-right: 1px solid gray;\",width:375},[$(\"vcl/ui/Tabs#left-sidebar-tabs\",[$(\"vcl/ui/Tab\",{text:locale(\"Navigator\"),control:\"navigator\",selected:true}),$(\"vcl/ui/Tab\",{text:locale(\"Open Tabs\"),control:\"openTabs\"}),$(\"vcl/ui/Tab\",{text:locale(\"Console\"),control:\"console\"}),$(\"vcl/ui/Tab\",{text:locale(\"Outline\"),control:\"outline\"}),$(\"vcl/ui/Tab\",{text:locale(\"Bookmarks\"),control:\"bookmarks\",visible:false}),$(\"vcl/ui/Tab\",{text:locale(\"Search\"),control:\"search-panel\",visible:false}),$([\"ui/controls/SizeHandle\"],{classes:\"horizontal\",vars:\"control: left-sidebar;\"})]),$([\"./Navigator<>\"],\"navigator\"),$([\"./Bookmarks\"],\"bookmarks\",{align:\"client\",visible:false}),$([\"./Outline\"],\"outline\",{_align:\"client\",visible:false}),$([\"./OpenTabs\"],\"openTabs\",{visible:false}),$([\"./Console\"],\"console\",{visible:false}),$(\"vcl/ui/Panel\",\"search-panel\",{align:\"client\",visible:false}),$(\"vcl/ui/Panel\",\"inspector-panel\",{align:\"client\",visible:false})]],[\"vcl/ui/Panel\",(\"editors\"),{align:\"client\",css:\"background-color: silver;\"},[[\"vcl/ui/Tabs\",\"editors-tabs\",{onChange:function(tab,previous){var title=this.app().getTitle(),me=this;this.setTimeout(\"foo\",function(){var ws=me.app().qs(\":root:selected\");ws=ws!==null?ws.getSpecializer():\"\";if(tab){document.title=String.format(\"%s - [%s > %s]\",tab.getVar(\"resource.uri\"),title,ws);}else{}},0);this._owner.emit(\"state-dirty\");},onDblClick:function(){var me=this,parent=this.up().qsa(\"devtools/Editor<>:root:visible\").pop();parent=parent?js.up(parent.vars([\"resource.uri\"])):\"Projects/tmp\";this.app().prompt(\"#editor-needed execute\",parent+\"/Resource-\"+Math.random().toString(36).substring(2,15),function(value){if(value!==null){me.up().qs(\"#editor-needed\").execute(value).setSelected(true);}});}}]]]]];");
define("text!vcl-comps/devtools/Navigator.js", "\"vcl/ui/Node, vcl/ui/ListHeader, devtools/NavigatorNode, devtools/Resources, js/Method, v7/pdok/viewer-metadata, v7/pdok/themes\";var Method=require(\"js/Method\");var Resources=require(\"devtools/Resources\");var NavigatorNode=require(\"devtools/NavigatorNode\");var needsParent=[\"src\",\"build\",\"vcl-comps\",\"css\",\"images\",\"img\",\"lib\",\"pages\",\"cavalion-blocks\"];function getNodeText(uri,usedNames){var r=[];usedNames=usedNames||[];r.push((uri=uri.split(\"/\")).pop());while(uri.length>0&&(needsParent.indexOf(r[0])!==-1||usedNames.indexOf(r.join(\"/\"))!==-1)){r.unshift(uri.pop());}\nreturn r.join(\"/\");}\nfunction onNodesNeeded(parent){var owner=this._owner;var root=parent===this;var uri=parent.vars(\"resource.uri\")||\"\";var control=parent.vars(\"control\");var uris=this._owner.vars(\"uris\");if(uris){if(!uris.hasOwnProperty(\"splice\")){Method.override(uris,{splice:function(index,count){for(var i=0;i<count;++i){var node=uriNodes[this[index+i]];node&&node.destroy();}\nreturn Method.callInherited(this,arguments);},push:function(){for(var i=0;i<arguments.length;++i){createUriNode(arguments[i]).setIndex(0);}\nreturn Method.callInherited(this,arguments);}});}\nvar favorites=this.vars([\"#navigator favorites\",true])||[];favorites.forEach(function(uri){if(uris.indexOf(uri)===-1){Array.prototype.push.apply(uris,[uri]);}});uris=uris.sort(function(i1,i2){var e1=i1.endsWith(\";File\"),e2=i2.endsWith(\";File\");return e1===e2?i1<i2?-1:1:e1?1:-1;});if(root){var uriNodes={};function createUriNode(uri,index){var node=new NavigatorNode(owner);var favorite=favorites.indexOf(uri)!==-1;uri=uri.split(\";\");var item={uri:uri[0],name:uri[1]||getNodeText(uri[0]),type:uri[2]||\"Folder\"};root&&node.addClass(\"root\");favorite&&node.addClass(\"favorite\");favorite&&(index===0)&&node.addClass(\"seperator top\");node.setVar(\"resource\",item);node.setChecked(true);node.setExpandable(item.expandable||item.type.indexOf(\"Folder\")!==-1);node.setParent(parent);return(uriNodes[uri[1]]=node);}\nuris.forEach(createUriNode);}\nthis.apply(\"Resources.index\");}\nvar r=this.apply(\"Resources.list\",[uri]).then(function(res){res.sort(function(i1,i2){if(i1.type===i2.type){return i1.name<i2.name?-1:1;}\nreturn i1.type!==\"Folder\"?1:-1;});parent.beginLoading();res.forEach(function(item,index){var node=new NavigatorNode(owner);item.uri=item.uri||(uri!==\"\"?(uri+\"/\"+item.name):item.name);node.setVar(\"resource\",item);root&&node.addClass(\"root\");root===true&&index===0&&parent._name===\"fs\"&&node.addClass(\"seperator top\");if(uris){var checked=false;for(var i=0;i<uris.length&&!checked;++i){checked=uris[i].indexOf(item.uri)===0;}\nif(checked&&uris.indexOf(item.uri)===-1){node.addClass(\"opaque-50\");}}\nnode.setChecked(checked);if(control){node.setVar(\"control\",control);}\nnode.setExpandable(item.expandable||item.type.indexOf(\"Folder\")!==-1);node.setParent(parent);});parent.endLoading();return res;});return r;}\n[\"vcl/ui/Form\",{activeControl:\"search-input\",onDispatchChildEvent:function(component,name,evt,f,args){if(name.indexOf(\"key\")===0){var scope=this.scope();if(component!==scope.tree&&!scope.tree.isParentOf(component)&&name===\"keyup\"&&evt.keyCode===evt.KEY_F5){scope.tree.refresh();}else if(component===scope['search-input']){if([13,27,33,34,38,40].indexOf(evt.keyCode)!==-1){var list=scope['search-list'];if(evt.keyCode===13&&list.getSelection().length===0&&list.getCount()){list.setSelection([0]);}else if(evt.keyCode===27){scope['search-input'].setValue(\"\");scope['search-input'].fire(\"onChange\",[true]);}\nif(list.isVisible()){list.dispatch(name,evt);}\nevt.preventDefault();}}}\nreturn this.inherited(arguments);},onDestroy:function(){this.app().qsa(\"devtools/DragDropHandler<>\").un(this.vars(\"listeners\"));},onLoad:function(){var scope=this.scope();var me=this;var indexing=0;var lists={};var index={};var uris=[];me.setVar(\"uris\",uris);me.setVar(\"index\",index);me.setVar(\"Resources\",{index:function(){if(!uris.length)return;var run=++indexing;scope['search-input'].addClass(\"searching\");return Resources.index(uris).then(function(res){if(run===indexing){for(var k in lists){if(lists[k]instanceof Array){index[k]=lists[k];}}\njs.mixIn(index,res);scope.search.execute();}\nscope['search-input'].removeClass(\"searching\");return res;}).catch(function(res){scope['search-input'].removeClass(\"searching\");return res;});},list:function(uri){lists[uri]=Resources.list(uri);return lists[uri].then(function(res){lists[uri]=res;return(index[uri]=res);});},refresh:function(uri){delete lists[uri];}});scope.tree.override({refresh:function(){this._controls.forEach(function(node){node.reloadChildNodes();});}});this.vars(\"listeners\",this.app().qsa(\"devtools/DragDropHandler<>\").on(\"dropped\",()=>this.qsa(\"#DragDropHandler_files\").map(node=>{node.show();node.reloadChildNodes();node.setExpanded(true);})));return this.inherited(arguments);}},[[\"vcl/data/Array\",\"search-results\",{}],[(\"vcl/Action\"),\"search-open\",{onExecute:function(evt){var list=this.scope('search-list'),me=this;var ws=this.up(\"devtools/Workspace<>:root\");var a=ws.down(\"#editor-needed\");list.getSelection(true).forEach(function(resource){var metadata=require(\"v7/pdok/viewer-metadata\");var themes=require(\"v7/pdok/themes\");if(resource.uri.startsWith(metadata.uri)){ws.qsa(\"veldapps/OpenLayers<PDOK-v1> #layer-needed\").execute({layer:resource});}else if(resource.uri.startsWith(themes.uri)){ws.qsa(\"veldapps/OpenLayers<>:root #layer-needed\").execute({layer:resource});}else{a.execute({resource:resource,selected:true});}},this);}}],[(\"vcl/Action\"),\"search\",{onExecute:function(){var scope=this.getScope();var text=scope['search-input'].getInputValue();var lower=text.toLowerCase();var index=this._owner.getVar(\"index\");var exacts=[],lowers=[],names=[],uris=[];function sort(i1,i2){return i1.name<i2.name?-1:1;}\nfor(var k in index){index[k].forEach(function(item){if(item.name===text){exacts.push(item);}else if(item.name.toLowerCase()===lower){lowers.push(item);}else if(item.name.toLowerCase().indexOf(lower)!==-1){names.push(item);}else if(item.uri.toLowerCase().indexOf(lower)!==-1){uris.push(item);}});}\nscope['search-results'].setArray([exacts.sort(sort),lowers,names,uris].reduce(function(prev,curr){return prev.concat(curr.sort(sort));}));}}],[(\"vcl/Action\"),\"resource-focus\",{onExecute:function(evt){var scope=this.getScope();var names=evt.resource.uri.split(\"/\");var path=[];var sidebar=this.up(\"devtools/Workspace<>:root\").down(\"#left-sidebar\");sidebar.show();sidebar.update(function(){var node=scope.tree.getSelection()[0]||null;if(node!==null&&evt.resource.uri===node.getVar(\"resource.uri\")){scope.tree.makeVisible(node);return;}\nscope['search-list'].hide();function walk(parent){path.push(names.shift());node=parent.getControls().find(function(node){return node.getVar(\"resource.uri\")===path.join(\"/\");});if(node){scope.tree.setTimeout(\"makeVisible\",function(){scope.tree.makeVisible(node);},20);if(names.length){node.childNodesNeeded(function(){node.setExpanded(true);node.setTimeout(\"walk\",function(){walk(node);},50);});}else{scope.tree.setSelection([node]);}}}\nwalk(scope.fs);});}}],[(\"vcl/Action\"),\"resource-new\",{}],[(\"vcl/Action\"),\"resource-delete\",{}],[\"vcl/ui/Bar\",\"search-bar\",{classes:\"no-border\"},[$(\"vcl/ui/Input\",\"search-input\",{placeholder:\"Filter (⌥+F)\",classes:\"search-top\",onDblClick(){var scope=this.getScope();scope['search-list'].hide();this.setValue(\"\");this._nodes.input.value=\"\";},onFocus(){this.fire(\"onChange\",[!this.getInputValue()]);},onBlur(){this.fire(\"onChange\",[false]);},onChange(evt){var scope=this.getScope();var value=this.getInputValue();var hasChecking=scope.tree.hasClass(\"checking\");var hasValue=scope.tree.hasClass(\"value\");var should=typeof evt===\"boolean\"?evt:(this.isFocused());scope['search-list'].setVisible(!!value);if(should&&!hasChecking){scope.tree.addClass(\"checking\");scope.tree.setTimeout(\"removeClass\",function(){scope.tree.removeClass(\"checking\");},2000);}else if(!should&&hasChecking){scope.tree.setTimeout(\"removeClass\",function(){scope.tree.removeClass(\"checking\");},100);}\nif(typeof evt!==\"boolean\"){scope.search.execute(evt);}},})]],[(\"vcl/ui/Tree\"),\"tree\",{css:{\".{Node}.root-invisible\":{\"> *:not(ol)\":\"display:none;\",\"> ol\":\"padding-left: 0;\"},\"padding-left\":undefined,\"overflow-x\":undefined,\".{./Node}\":{\"&.seperator.bottom\":{\"border-bottom\":\"1px solid #f0f0f0\",\"margin-bottom\":\" 2px\",\"padding-bottom\":\"2px\"},\"&.seperator.top\":{\"border-top\":\"1px solid #f0f0f0\",\"margin-top\":\" 2px\",\"padding-top\":\"2px\"},\">.checkbox\":{position:\"absolute\",right:\"4px\",\"z-index\":\"1\",display:\"none\"},\"&.no-icon >.icon\":\"width:14px;\",\">.text\":\"padding-left:0;\",\">.icon\":{width:\"32px\",\"background-repeat\":\"no-repeat\",\"background-position-x\":\"14px\",\"background-position-y\":\"2px\",\"background-size\":\"16px 16px\"},\"&.folder >.icon\":{\"background-image\":\"url(https://image.flaticon.com/icons/svg/148/148953.svg)\"},\"&.file >.icon\":{\"background-image\":\"url(https://image.flaticon.com/icons/svg/660/660720.svg)\",},\">.text>.desc\":{\"font-size\":\"7.5pt\",color:\"silver\",\"pointer-events\":\"none\"},\"&.opaque-50\":{\">.checkbox\":{opacity:\"0.5\"}}},\"&.checking .{./Node}.folder:not(.favorite):not(.root-invisible) >.checkbox\":{display:\"block\"},\"&.busy\":{background:\"url(/shared/vcl/images/loading.gif) no-repeat 50%,50%\",\".{./Node}\":{opacity:\"0.5\"}}},onDispatchChildEvent:function(component,name,evt,f,args){var resource,owner=this._owner;var app=this.app();var selection=this.getSelection();if(selection.length&&name===\"keydown\"){if(evt.keyCode===evt.KEY_DELETE||evt.keyCode===evt.KEY_F8){evt.preventDefault();app.confirm(String.format(\"You are about to delete the \"+\"following resource%s:\\n- %s\\n\\nAre you sure to continue?\",selection.length>1?\"s\":\"\",selection.map(function(node){return node.getVar(\"resource.uri\");}).join(\"\\n- \")),function(res){if(res===true){selection.forEach(function(node){node.setEnabled(false);node.setExpanded(false);node.getNode().style.opacity=\"0.5\";Resources['delete'](node.getVar(\"resource.uri\")).then(function(){node.destroy();}).catch(function(err){node.setEnabled(true);node.getNode().style.opacity=\"\";});})}});}\nif(evt.keyCode===evt.KEY_INSERT||evt.keyCode===evt.KEY_F9){if(selection[0].getVar(\"resource.type\")===\"Folder\"){app.prompt(\"Enter uri for new resource:\",selection[0].getVar(\"resource.uri\")+\"/\",function(uri){if(uri!==null){Resources.create(uri,{text:\"\"}).then(function(res){selection[0].reloadChildNodes();app.qsa(\"devtools/Workspace<>:owner-of(.) #editor-needed\",owner).execute({resource:{uri:uri},selected:true});}).catch(function(res){alert(res);});}});}}}\nif(name===\"dblclick\"&&(component.hasClass(\"file\")||evt.shiftKey===true)){if((resource=component.getVar(\"resource\"))){this.up(\"devtools/Workspace<>:root\").down(\"#editor-needed\").execute({resource:resource,selected:true});evt.preventDefault();return false;}}\nif(name===\"click\"&&evt.target.nodeName===\"INPUT\"){var uris=this._owner.getVar(\"uris\");var uri=component.getVar(\"resource.uri\");var checked=component.getChecked();var index=uris.indexOf(uri);if(index!==-1&&!checked){uris.splice(index,1);}else{uris.push(uri);}\nthis._owner.writeStorage(\"uris\",JSON.stringify(uris));var me=this;this.setTimeout(\"refresh-index\",function(){me.apply(\"Resources.index\");},750);}\nif(this.hasClass(\"checking\")){var me=this;this.setTimeout(\"removeClass\",function(){me.removeClass(\"checking\");},2000);}},_onNodesNeeded:function(parent){var owner=this._owner;var root=parent===null;parent=parent||this;var uri=parent.getVar(\"resource.uri\")||\"\";var control=parent.getVar(\"control\");var uris=this._owner.getVar(\"uris\").sort(function(i1,i2){return i1<i2?-1:1;});if(root){var uriNodes={};function createUriNode(uri){var node=new NavigatorNode(owner);uri=uri.split(\";\");var item={uri:uri[0],name:uri[1]||getNodeText(uri[0]),type:uri[2]||\"Folder\"};root&&node.addClass(\"root\");node.setVar(\"resource\",item);node.setChecked(true);node.setExpandable(true);node.setParent(parent);return(uriNodes[uri[1]]=node);}\nuris.forEach(createUriNode);Method.override(uris,{splice:function(index,count){for(var i=0;i<count;++i){var node=uriNodes[this[index+i]];node&&node.destroy();}\nreturn Method.callInherited(this,arguments);},push:function(){for(var i=0;i<arguments.length;++i){createUriNode(arguments[i]).setIndex(0);}\nreturn Method.callInherited(this,arguments);}});}\nvar r=this._owner.apply(\"Resources.list\",[uri]).then(function(res){res.sort(function(i1,i2){if(i1.type===i2.type){return i1.name<i2.name?-1:1;}\nreturn i1.type!==\"Folder\"?1:-1;});parent.beginLoading();res.forEach(function(item,index){var node=new NavigatorNode(owner);item.uri=uri!==\"\"?(uri+\"/\"+item.name):item.name;node.setVar(\"resource\",item);root&&node.addClass(\"root\");root===true&&index===0&&node.addClass(\"seperator top\");var checked=false;for(var i=0;i<uris.length&&!checked;++i){checked=uris[i].indexOf(item.uri)===0;}\nif(checked&&uris.indexOf(item.uri)===-1){node.addClass(\"opaque-50\");}\nnode.setChecked(checked);if(control){node.setVar(\"control\",control);}\nconsole.log(node,js.sf(\"expandable: %s\",item.expandable));node.setExpandable(item.expandable||item.type.indexOf(\"Folder\")!==-1);node.setParent(parent);});parent.endLoading();return res;});return r;},onNodesNeeded:function(parent){var node=parent,pname=\"_onChildNodesNeeded\";while(node&&!node.hasOwnProperty(pname)){node=node._parent;}\nif(node===parent)return;if(node&&node.hasOwnProperty(pname)){return node.fire(pname.substring(1),[parent]);}}},[[(\"devtools/NavigatorNode\"),\"Component_storage\",{vars:{resource:{type:\"Folder\",uri:js.sf(\"pouchdb://%s/\",require(\"vcl/Component\").storageDB.name),name:js.sf(\"Local Resources\",require(\"vcl/Component\").storageDB.name),}},onNodesNeeded:onNodesNeeded,}],[(\"devtools/NavigatorNode\"),\"fs\",{vars:{resource:{type:\"Folder\",uri:\"/\",name:js.sf(\"Server Resources\")}},classes:\"root-invisible\",expanded:true,onLoad:function(){this.vars(\"static-nodes\",[].concat(this._controls));},onNodesNeeded:onNodesNeeded}],[(\"devtools/NavigatorNode\"),\"DragDropHandler_files\",{vars:{resource:{type:\"Folder\",uri:\"dropped://\",name:\"Dropped Resources\"}},classes:\"seperator top\",expandable:true,visible:false,onNodesNeeded:onNodesNeeded}]]],[(\"vcl/ui/List\"),\"search-list\",{action:\"search-open\",source:\"search-results\",visible:false,css:{\"background-color\":\"white\",\".{./ListHeader}\":{height:\"0\"},\".ListCell\":{\"margin-top\":\"1px\",\"padding-top\":\"4px\",\"padding-left\":\"34px\",\"background-repeat\":\"no-repeat\",\"background-position-x\":\"14px\",\"background-position-y\":\"1px\",\"&.file\":{\"background-image\":\"url(/shared/vcl/images/file16.png)\",},\"&.folder\":{\"background-image\":\"url(/shared/vcl/images/folder16.png)\",},\"span\":{\"font-size\":\"7.5pt\",color:\"silver\"}}}},[[(\"vcl/ui/ListColumn\"),{content:\"#\",rendering:\"innerHTML\",attribute:\".\",onGetValue:function(value,row,source){return[String.format(\"%H <span> - %H</span>\",value.name,value.uri.replace(/^Workspaces\\/[^\\/]*\\//,\"../\"))];},onRenderCell:function(cell,value,column,row,source,orgValue){var classes=cell.className.split(\" \");if(classes.length===4){classes.pop();}\nclasses.push(orgValue.type===\"Folder\"?\"folder\":\"file\");cell.className=classes.join(\" \");}}]]]]];");
define("text!vcl-comps/devtools/Bookmarks.js", "()=>{var Veloffice=require(\"entities/EM!Veldoffice\");var EM=require(\"entities/EM\");var Bookmarks=require(\"entities/EM!Bookmarks\");EM.monitor(\"veldoffice:Onderzoek#3432/meetpunten\",{}).addCallback(function(){});};$([\"ui/Form\"],{},[]);");
define("text!vcl-comps/devtools/Outline.js", "\"vcl/ui/Node, vcl/Factory\";$(\"vcl/ui/Tree\",{css:{\".{./Node}\":{\"&:not(.selected) > .text > .class\":{color:\"silver\",\">a\":{color:\"rgba(0, 0, 255, 0.75)\"}},\"> .text > .class\":{\">a\":{\"font-size\":\"6.5pt\",\"text-decoration\":\"underline\",cursor:\"pointer\"}},\".root\":{\"font-weight\":\"bold\"}}},onLoad:function(){this.dispatch(\"nodesneeded\",null);return this.inherited(arguments);},onNodeCreated:function(){var app=this.getApp();var me=this;this._node.addEventListener(\"click\",function(e){if(e.target.nodeName===\"A\"){var uri=e.target.textContent;if(uri.charAt(0)!==\"#\"){if(uri.indexOf(\"<\")){uri=uri.split(\"<\").join(\"$/\").split(\">\").join(\"\");}\nuri+=\".js\";if(e.target.classList.contains(\"module\")){uri=\"cavalion-vcl/lib/cavalion.org/\"+uri;}else if(e.target.classList.contains(\"vcl\")){uri=js.sf(\"Library/vcl-comps/\"+uri);}else if(e.target.classList.contains(\"blocks\")){uri=js.sf(\"Library/cavalion-blocks/\"+uri);}\napp.qsa(\"devtools/Workspace<>:owner-of(.) #editor-needed\",me).execute({resource:{uri:uri},selected:true});}else{app.emit(\"print\",require(\"js/JsObject\").all[parseInt(uri.substring(1))]);}}});},onNodesNeeded:function(parent){var Node=require(\"vcl/ui/Node\"),VclFactory=require(\"vcl/Factory\");var owner=this;var arr;if(parent===null){arr=require(\"vcl/Component\").all.reduce(function(arr,item){if(item._isRoot){arr.push(item);}\nreturn arr;},[]);parent=this;}else{arr=parent.getVar(\"component\")._components||[];}\narr.forEach(function(comp){var node=new Node(owner);var className=comp.constructor['@class obj'].name;var name=comp._name;var vcl=comp['@factory']instanceof VclFactory;if(comp._isRoot){if(!(name=comp._name)){name=comp._uri;if(name.indexOf(\"<\")===-1){name+=\"<>\";}}}\nif(name){node.setText(String.format(\"<span class='name%s'>%H</span>\\\n                 <span class='class'>- <a class='module'>%H</a> - \\\n                 <a class='vcl'>%H</a> - <a>#%d</a></span>\",comp._isRoot?\" root\":\"\",name,className,comp._uri,comp.hashCode()));}else{node.setText(String.format(\"<span class='class'>- <a class='module'>%H</a> - \\\n                 <a class='vcl'>%H</a> - <a>#%d</a></span>\",className,comp._uri,comp.hashCode()));}\nnode.setVar(\"component\",comp);node.setParent(parent);node.setExpandable(comp._components);});}},[]);");
define("text!vcl-comps/devtools/OpenTabs.js", "\"vcl/ui/ListHeader\";$(\"vcl/ui/Form\",{activeControl:\"search-input\",onDispatchChildEvent:function(component,name,evt,f,args){if(name.indexOf(\"key\")===0){var scope=this.scope();if(component===scope['search-input']){if([13,27,33,34,38,40,116].indexOf(evt.keyCode)!==-1){var list=scope.list;if(evt.keyCode===116){this._onActivate.apply(this,[this._parent]);}else if(evt.keyCode===13&&list.getSelection().length===0&&list.getCount()){list.setSelection([0]);}else if(evt.keyCode===27){scope['search-input'].setValue(\"\");scope['search-input'].fire(\"onChange\",[true]);}else if(list.isVisible()){list.dispatch(name,evt);}\nevt.preventDefault();}}}\nreturn this.inherited(arguments);},onActivate:function(parent){this.scope(\"editors-array\").setArray(this.up(\"devtools/Workspace<>:root\").qsa(\"vcl/ui/Tab\").map(function(tab){var resource=tab.getVar(\"resource\");return!(resource&&resource.uri)?null:{name:resource.uri.split(\"/\").pop(),uri:resource.uri};}).filter(function(resource){return resource;}).sort(function(res1,res2){return res1.name<res2.name?-1:1;}));return this.inherited(arguments);}},[$(\"vcl/data/Array\",\"editors-array\",{onFilterObject:function(obj){var filter=this.getVar(\"filter\");return filter?obj.uri.indexOf(filter)===-1:false;}}),$(\"vcl/Action\",\"editor-open\",{onExecute:function(evt){var list=this.scope('list');var a=this.up(\"devtools/Workspace<>:root\").down(\"#editor-needed\");list.getSelection(true).forEach(function(resource){a.execute({resource:resource,selected:true});},this);}}),$(\"vcl/Action\",\"search-focus\",{hotkey:\"MetaCtrl+191|Alt+F\",onExecute:function(){var scope=this.getScope();var previous=this.getVar(\"previous\");var now=Date.now();if(previous!==undefined&&now-previous<175){scope['search-input'].setValue(\"\");scope['search-input'].fire(\"onChange\",[true]);}\nscope['search-input'].setFocus(true);this.setVar(\"previous\",now);}}),$(\"vcl/Action\",\"search\",{onExecute:function(){var scope=this.getScope();var text=scope['search-input'].getInputValue();var lower=text.toLowerCase();var index=this._owner.getVar(\"index\");var exacts=[],lowers=[],names=[],uris=[];function sort(i1,i2){return i1.name<i2.name?-1:1;}\nfor(var k in index){index[k].forEach(function(item){item.uri=k?(k+\"/\"+item.name):item.name;if(item.name===text){exacts.push(item);}else if(item.name.toLowerCase()===lower){lowers.push(item);}else if(item.name.toLowerCase().indexOf(lower)!==-1){names.push(item);}else if((k+\"/\"+item.name).toLowerCase().indexOf(lower)!==-1){uris.push(item);}});}\nscope['editors-array'].setArray([exacts.sort(sort),lowers,names,uris].reduce(function(prev,curr){return prev.concat(curr.sort(sort));}));}}),$(\"vcl/ui/Bar#search-bar\",{classes:\"no-border\"},[$(\"vcl/ui/Input#search-input\",{placeholder:\"Filter (⌥+F)\",onDblClick:function(){this.setInputValue(\"\");},onFocus:function(){this.fire(\"onChange\",[!this.getInputValue()]);},onBlur:function(){this.fire(\"onChange\",[false]);},onChange:function(evt){var array=this.scope()['editors-array'];array.setVar(\"filter\",this.getInputValue());array.updateFilter();}})]),$(\"vcl/ui/List\",\"list\",{align:\"client\",action:\"editor-open\",source:\"editors-array\",css:{\"background-color\":\"white\",\".{./ListHeader}\":{height:\"0\"},\".ListCell\":{\"margin-top\":\"1px\",\"padding-top\":\"5px\",\"padding-left\":\"34px\",\"background-repeat\":\"no-repeat\",\"background-position-x\":\"14px\",\"background-position-y\":\"1px\",\"&.file\":{\"background-image\":\"url(/shared/vcl/images/file16.png)\",},\"&.folder\":{\"background-image\":\"url(/shared/vcl/images/folder16.png)\",},\"span\":{\"font-size\":\"7.5pt\",color:\"silver\"}}}},[$(\"vcl/ui/ListColumn\",{content:\"#\",attribute:\".\",rendering:\"innerHTML\",onGetValue:function(value,row,source){return[String.format(\"%H <span> - %H</span>\",value.name,value.uri)];},onRenderCell:function(cell,value,column,row,source,orgValue){var classes=cell.className.split(\" \");if(classes.length===4){classes.pop();}\nclasses.push(orgValue.type===\"Folder\"?\"folder\":\"file\");cell.className=classes.join(\" \");}})])]);");
define("text!vcl-comps/devtools/Console.js", "\"use devtools/Resources\";var Resources=require(\"devtools/Resources\");[\"vcl/ui/Form\",(\"\"),{activeControl:\"console\"},[[\"vcl/ui/Console\",(\"console\"),{classes:\"no-time\",onEvaluate(expr){var scope=this.scope();var app=this.app(),me=this;var ws=this.up(\":root\");var ace=ws&&ws.down(\"devtools/Editor<>:root < vcl/ui/Ace:visible\");var ed=ace?ace.getEditor():null;var pr=this.print.bind(this);var open=(uri,opts)=>me.bubble(\"openform\",js.mixIn(js.mixIn(opts||{}),{uri:uri}));var ls=(path)=>Resources.list(path||\"/\");return eval(expr);}}]]];");
define("text!vcl-comps/make/Build.js", "$([],{vars:{modules:[],components:[]}});");
define("text!vcl-comps/devtools/Editor$/html.js", "\"use pages/Controller, Framework7\";var q$=require(\"jquery\");$([],{onLoad:function(){var resource=this.getVar(\"resource\",true);var scope=this.scope();if((resource.uri.indexOf(\"/V7/src/\")!==-1||resource.uri.indexOf(\"/src/pages/\")!==-1||resource.uri.indexOf(\".page/.html\")!==-1)||(resource.uri.indexOf(\"/src/gdtis/pages/\")!==-1)){require(\"pages/Controller\");scope.preview.setClasses(\"fw7 ios\");}\nscope.preview.override({layoutChanged:function(){this.inherited();var template;if(this._node.childNodes.length&&(template=this._node.childNodes[0]).nodeName===\"TEMPLATE\"){var instance=document.importNode(template.content,true);this._node.insertBefore(instance,template);}\nvar node=this._node.childNodes[0]||{};if(node.className===\"popup\"&&node.childNodes.length){node.className=\"popup_\";if(node.childNodes[0].className===\"view\"){node.childNodes[0].className=\"view_\";}}}});return this.inherited(arguments);}},[$i((\"ace\"),{onLoad:function(){var scope=this.scope();var uri=this.vars([\"resource.uri\"]);if(uri.indexOf(\"vcl-comps/f7/Page$/\")!==-1){require([\"Framework7\",\"font-awesome\"]);scope.preview.addClass(\"f7-body\");}\nif(uri.indexOf(\"index.html\")!==-1){scope.preview.setVisible(false);}\nreturn this.inherited(arguments);},onChange:function(){this.setTimeout(\"render\",function(){this.scope().render.execute();}.bind(this),250);},align:\"client\"}),$((\"vcl/Action\"),\"render\",{onExecute:function(evt){var scope=this.scope();evt=evt||{value:scope.ace.getValue()};var root=scope.preview._node;var pos=q$(\"*\",root).toArray().filter(_=>_.scrollTop).map(_=>{var n=_,s=[];while(n!==root){s.unshift(n.nodeName.toLowerCase()+(n.className?(\".\"+n.className.split(\" \").join(\".\")):\"\"));n=n.parentNode;}\nreturn[s.join(\" > \"),_.scrollTop];});var uri=this.vars([\"resource.uri\"]);var data=this._owner.vars(\"data\")||this.vars([\"devtools/Editor<html>://\"+uri]);try{scope.preview.setContent(Template7.compile(evt.value)(data));}catch(e){this.print(e);scope.preview.setContent(js.sf(\"<div style='padding:8px;background-color:red;color:white;font-weight:bold;'>%H</div>%s\",e.message,evt.value));}\ntry{scope.preview.update(_=>pos.forEach(p=>q$(p[0]).scrollTop(p[1])));}catch(e){}},}),$((\"vcl/ui/Panel\"),\"preview\",{align:\"right\",width:375,css:{\"background-color\":\"#f0f0f0\",\"border-left\":\"1px solid silver\",\"border-right\":\"1px solid silver\",\"&.fw7\":{\"font-family\":\"-apple-system, SF UI Text, Helvetica Neue, Helvetica, Arial, sans-serif\",\"background-color\":\"rgba(224,224,224,0.8)\",\"border-radius\":\"12px\"}},visible:true,vars:{\"wrapper-start\":\"<div><h1>PREVIEW</h1><div>\",\"wrapper-end\":\"</div><h3>FOOTER</h3></div>\"},onLoad(){this.override(\"setContent\",function(value){var args=[js.sf(\"%s%s%s\",this.vars(\"wrapper-start\"),value,this.vars(\"wrapper-end\"))];args.callee=arguments.callee;return this.inherited(args);});}})]);");
define("text!vcl-comps/devtools/Editor.js", "\"devtools/Resources, util/Xml, vcl/ui/Tab, ace/range, util/Event\";var Event_=require(\"util/Event\");var Resources=require(\"devtools/Resources\");var nameOf=(uri)=>(uri||\"\").split(\"/\").pop().replace(/\\//g,\".\");var getKey=(tab)=>{var parents=[];while(tab!==null&&tab.vars(\"resource\")){parents.unshift(tab);tab=tab.up(\"vcl/ui/Tab\");}\nparents=parents.map(_=>nameOf(_.vars(\"resource.uri\")));return parents.join(\"/\");};[[\"ui/Form\"],{activeControl:\"ace\",onLoad(){var tab=this.up(\"vcl/ui/Tab\");var scope=this.getScope();var ExtensionToMode={\"html\":\"html\",\"css\":\"css\",\"scss\":\"scss\",\"json\":\"json\",\"geojson\":\"json\",\"js\":\"javascript\",\"jso\":\"javascript\",\"blocks\":\"javascript\",\"vcl\":\"javascript\",\"ts\":\"typescript\",\"md\":\"markdown\",\"java\":\"java\",\"jsx\":\"jsx\",\"rdf\":\"xml\",\"wsdl\":\"xml\",\"xsd\":\"xml\",\"xml\":\"xml\",\"xsl\":\"xml\",\"jsp\":\"jsp\"};var ed=scope.ace.getEditor();ed.setTheme(\"ace/theme/eclipse\");ed.renderer.setHScrollBarAlwaysVisible(false);ed.setScrollSpeed(2);var resource=tab.vars([\"resource\"]);var name=resource.name||(resource.uri||\"\").split(\"/\").pop();var type=(resource.contentType||\"\").split(\"/\").pop();var ext=name.split(\".\").pop();var session=ed.getSession();var mode=\"ace/mode/\"+(ExtensionToMode[type||ext||this.getSpecializer()]||(type||ext||this.getSpecializer()||\"js\"));require([mode],function(){session.setMode(mode);},function(){console.log(\"Unknown mode \"+mode);});session.setUseWrapMode(false);session.setWrapLimitRange(null,null);session.on(\"change\",function(e){scope.ace.setTimeout(\"update\",function(){var modified=tab.getVar(\"modified\");if(modified===\"resetundo,gototop\"){session.getUndoManager().reset();tab.removeVar(\"modified\");tab.setState(\"invalidated\",true);}else{if(session.getUndoManager().hasUndo()){if(!modified){tab.setVar(\"modified\",true);tab.setState(\"invalidated\",true);}}else{if(tab.getVar(\"modified\")!==undefined){tab.removeVar(\"modified\");tab.setState(\"invalidated\",true);}}}},100);});scope.refresh.execute();return this.inherited(arguments);},vars:{reflectState(root,state){if(state===null)return;var ace=root.down(\"#ace\");var session=ace.getEditor().session;if(state.position){ace.getEditor().gotoLine(state.position.row+1,state.position.column);}\nstate.selection&&session.selection.fromJSON(state.selection);state.options&&session.setOptions(state.options);state.mode&&session.setMode(state.mode);state.folds&&state.folds.forEach(function(fold){try{var Range=require(\"ace/range\").Range;session.addFold(fold.placeholder,Range.fromPoints(fold.start,fold.end));}catch(e){console.error(e);}});session.setScrollTop(state.scrollTop);session.setScrollLeft(state.scrollLeft);}}},[[\"vcl/Action\",(\"menu-open\"),{hotkey:\"Shift+F10\",onExecute:function(evt){this.udown(\"#ace\").getEditor().execCommand(\"showSettingsMenu\",evt.args||[]);}}],[\"vcl/Action\",(\"refresh\"),{hotkey:\"MetaCtrl+R\",onExecute:function(evt){var scope=this.getScope();var tab=this.up(\"vcl/ui/Tab\");var resource=tab.getVar(\"resource\");var editor=scope.ace.getEditor();if(resource){scope.loading.show();editor.setReadOnly(true);editor.blur();Resources.get(resource.uri).then(function(res){if(res.text!==undefined&&res.text!==editor.session.getValue()){tab.setVar(\"modified\",\"resetundo,gototop\");editor.session.setValue(res.text);}else{tab.removeVar(\"modified\");}\ntab.setVar(\"resource.revision\",res.revision);editor.setReadOnly(false);editor.focus();scope.loading.hide();tab.emit(\"resource-loaded\");}).catch(function(res){editor.setReadOnly(false);editor.focus();if(evt&&res.status===404){tab.app().confirm(String.format(\"404 - %s\\n\\nThis resource does not exist. Would you like to create it?\",resource.uri),function(res){if(res===true){Resources.create(resource.uri,resource).then(_=>editor.print(_)).catch(_=>editor.print(_));}});}\nscope.loading.hide();tab.emit(\"resource-loaded\");});}}}],[\"vcl/Action\",(\"save-resource\"),{onExecute:function(){var scope=this.getScope();var resource=this.getVar(\"resource\",true);var text=scope.ace.getValue();var editor=scope.ace.getEditor();var tab=this.up(\"vcl/ui/Tab\");if(!resource.uri||!tab.getVar(\"modified\")){return;}\nscope.loading.show();editor.setReadOnly(true);editor.blur();resource.text=editor.getValue();Resources.update(resource.uri,resource).then(function(res){editor.setReadOnly(false);editor.focus();scope.loading.hide();return res;}).then(function(res){tab.removeVar(\"modified\");tab.setState(\"invalidated\",true);if(res.hasOwnProperty(\"revision\")){resource.revision=res.revision;}\ntab.emit(\"resource-saved\");}).catch(function(res){var msg;if(res.status===404){tab.app().confirm(String.format(\"404 - %s\\n\\nThis resource does not exist. Would you like to create it?\",resource.uri),function(res){if(res===true){Resources.create(resource.uri,resource).then(_=>ace.print(_)).catch(_=>ace.print(_));}});}else if(res.status===409){msg=\"**WARNING*** - The resource has not been saved because it has been changed since loading it. Copy the contents of the resource (to the clipboard eg.) before reloading it.\";}else{console.error(res);msg=res.message;}\nmsg&&alert(String.format(\"%s\\n\\n%s - %s\",msg,res.status,res.statusText));scope.loading.hide();});}}],[\"vcl/Action\",(\"save\"),{hotkey:\"MetaCtrl+S\",parent:\"save-resource\",parentExecute:true}],[\"vcl/Action\",(\"format\"),{hotkey:\"MetaCtrl+Shift+F\",onExecute:function(){var Xml=require(\"util/Xml\");var scope=this.getScope();var editor=scope.ace.getEditor();var mode=editor.session.$modeId||\"\";switch(mode.split(\"/\").pop()){case\"javascript\":case\"json\":editor.setValue(js.b(editor.getValue()));break;case\"xml\":editor.setValue(Xml.beautify(editor.getValue()));break;default:alert(\"Don't know how to format this (yet)\");}}}],[\"vcl/Action\",(\"toggle-wrap\"),{hotkey:\"MetaCtrl+Shift+W\",onExecute:function(evt){var editor=this.scope().ace.getEditor();editor.getSession().setUseWrapMode(!editor.getSession().getUseWrapMode());evt.preventDefault();}}],[\"vcl/Action\",(\"evaluate\"),{hotkey:\"MetaCtrl+Enter|Alt+MetaCtrl+Enter|Shift+MetaCtrl+Enter\",onExecute:function(evt){var all=require(\"js/JsObject\").all;var Deferred=require(\"js/Deferred\");var parentRequire=require;var uri=\"$HOME/\"+this.vars([\"resource.uri\"]);function normalize(uri,module){if(module.includes(\"!\")){module=module.split(\"!\");module[1]=js.normalize(uri,module[1]);module=module.join(\"!\");}else{module=js.normalize(uri,module);}\nreturn module;}\nfunction thisRequire(modules,success,error){if(modules instanceof Array){modules=modules.map(module=>normalize(uri,module));}else{modules=normalize(uri,modules);}\nreturn parentRequire(modules,success,error);}\nfor(var k in parentRequire){thisRequire[k]=parentRequire[k];}\nfunction defer(requirements,callback){var deferred=new Deferred();require(requirements,function(){var args=[deferred].concat(js.copy_args(arguments));return callback.apply(this,args);});return deferred;}\nvar app=this.app(),ws=this.up(\"devtools/Workspace<>:root\");var name=this.vars(\"label\")||this.vars([\"resource.uri\"]).split(\"/\").pop();var scope=this.scope();var text=scope.ace.getEditor().getSession().getValue();var printer=ws||this;if(text.charAt(0)===\"{\"){text=\"(\"+text+\")\";}\ntry{(function(require){var eval_=this.vars(\"eval\"),value;if(Event_.modifiersMatch(evt,[\"metactrl\",\"shift\"])){value=\"'Meta+Shift+Pressed'\";}else if(Event_.modifiersMatch(evt,[\"metactrl\",\"alt\"])){var hash=req(\"util/Hash\").md5(scope.ace.getValue())\nvalue={me:this,root:(()=>{try{return eval_?eval_(text):eval(text);}catch(e){return e;}})(),text:text,text_len:text.length,text_hash:hash,text_lines:scope.ace.getValue().split(\"\\n\"),editor:this.up(),scope:this.scope(),resource:this.vars([\"resource\"]),};var root=value.scope['@owner'];var map=(value.factories={});(value.components=root._components).map(component=>{var uri=component._uri,pre=\"vcl/Factory!\"\nif(uri.indexOf(\"$HOME/\")===0)uri=uri.substring(\"$HOME/\".length);map[uri]=map[uri]||{instances:[],factory:component['@factory']};map[uri].instances.push(component);});value.controls=root._controls;value=Object.create(value,{name:{value:hash}});}else{value=eval_?eval_(text):eval(text);}\nprinter.print(name,value);}.apply(this,[thisRequire]));}catch(e){printer.print(name,e);}}}],[\"vcl/Action\",(\"focus-in-navigator\"),{hotkey:\"MetaCtrl+48\",onExecute:function(evt){var app=this.getApp();var resource=this.getVar(\"resource\",true);app.qsa(\"devtools/Workspace<>:owner-of(.) #navigator #resource-focus\",this).execute({resource:resource},this);}}],[\"vcl/ui/Ace\",(\"ace\"),{onLoad(){var ace=this;var writeStorage=()=>{var ed=ace.getEditor();ace.up().writeStorage(\"ace\",{position:ed.selection.getCursor(),selection:ed.selection.toJSON(),options:ed.session.getOptions(),folds:ed.session.getAllFolds().map(function(fold){return{start:fold.start,end:fold.end,placeholder:fold.placeholder};}),scrollTop:ed.session.getScrollTop(),scrollLeft:ed.session.getScrollLeft(),fontSize:ed.getFontSize()});};this.up(\"vcl/ui/Tab\").once(\"resource-loaded\",function(){var root=ace.up();root&&root.readStorage(\"ace\",function(state){var ed=ace.getEditor();if(state){state.position&&ed.gotoLine(state.position.row+1,state.position.column);state.selection&&ed.session.selection.fromJSON(state.selection);state.options&&ed.session.setOptions(state.options);state.mode&&ed.session.setMode(state.mode);state.folds&&state.folds.forEach(function(fold){try{var Range=require(\"ace/range\").Range;ed.session.addFold(fold.placeholder,Range.fromPoints(fold.start,fold.end));}catch(e){console.error(e);}});ed.session.setScrollTop(state.scrollTop);ed.session.setScrollLeft(state.scrollLeft);ed.setFontSize(state.fontSize||\"12px\");}\ned.selection.on(\"changeCursor\",writeStorage);ed.session.on(\"changeFold\",writeStorage);ed.session.on(\"changeSelection\",writeStorage);});});}}],[\"vcl/ui/Panel\",(\"loading\"),{align:\"none\",autoSize:\"both\",css:{opacity:\"0.75\",background:\"white url(/shared/vcl/images/loading.gif) no-repeat center center\",\"z-index\":\"10000\",left:0,top:0,bottom:0,right:0},visible:false,onLoad(){var canHide=Date.now();this.override({showNode:function(){this.clearTimeout(\"hideNode\");canHide=Date.now()+250;return this.inherited(arguments);},hideNode:function(){var me=this,args=js.copy_args(arguments);args.callee=arguments.callee;this.setTimeout(function(){me.inherited(args);},canHide-Date.now());}});}}]]];");
define("text!vcl-comps/devtools/Editor$/vcl.js", "\"vcl/Factory, vcl/ui/Node, vcl/ui/Tab\";var Component=require(\"vcl/Component\");var Factory=require(\"vcl/Factory\");var Node=require(\"vcl/ui/Node\");var Tab=require(\"vcl/ui/Tab\");$([\"./Editor<js>\"],{onLoad:function(){var tab=this.up(\"vcl/ui/Tab\");var scope=this.scope();var sourceUri=tab.getVar(\"resource.uri\",true);var uri=sourceUri.split(\".\");var ext=uri.pop(),index;uri=uri.join(\".\").split(\"/\");if((index=uri.indexOf(\"vcl-comps\"))!==-1){uri=uri.join(\"/\");if(uri.indexOf(\"$/\")!==-1){uri=uri.split(\"$\");uri=uri[0]+(\"<\"+uri.pop().substring(1)+\">\");}}else{uri=uri.join(\"/\");}\nif(uri.indexOf(\"/tools/vcl-comps/\")!==-1||uri.indexOf(\"/vcl-comps/tools/\")!==-1){scope['toggle-source'].setState(false);scope.ace.hide();scope['toggle-component'].setState(true);}\nvar keys=Component.getKeysByUri(this.up(\"devtools/Workspace<>\")._uri);uri=String.format(\"$HOME/%s\",uri);function f(){scope.instantiate.execute({uri:uri,sourceUri:sourceUri});}\ntab.on({\"resource-loaded\":f,\"resource-saved\":f});var resource=this.getVar(\"resource\",true);var node=new Node(this);node.setText(resource.uri);node.setExpandable(true);node.setParent(scope.tree);return this.inherited(arguments);},onResize:function(){this.setTimeout(\"alignControls\",32);}},[$(\"vcl/Action#instantiate\",{onExecute:function(evt){var scope=this.scope(),uri=evt.uri;if(!scope.host.isVisible()){return;}\nvar factory=new Factory(require,uri,evt.sourceUri);var root=scope.host.getControls()[0];var ws=root.up(\"devtools/Workspace<>\");while(root){root&&root.setParent(null);root=scope.host.getControls()[0];}\nfactory.load(scope.ace.getValue(),function(){try{root&&root.destroy();root=factory.newInstance(scope['@owner'],uri);if(root instanceof require(\"vcl/Control\")){root.setParent(scope.host);}else{root.qsa(\":instanceOf(vcl/Control)\").forEach(function(c){if(c.getParentComponent()===root){c.setParent(scope.host);}});}\nws.print(scope['@this'],root);}catch(e){alert(e.message);}},function(e){root&&root.show();if(e instanceof Error){console.error(e);alert(e.message);scope.host.up().print(e);}});}}),$(\"vcl/Action#toggle-source\",{hotkey:\"Shift+MetaCtrl+S\",selected:\"state\",visible:\"state\",state:true,onExecute:function(){this.setState(!this.getState());}}),$(\"vcl/Action#toggle-component\",{hotkey:\"Shift+MetaCtrl+C\",selected:\"state\",visible:\"state\",state:false,onExecute:function(){this.setState(!this.getState());}}),$(\"vcl/Action#toggle-instantiate\",{hotkey:\"Shift+MetaCtrl+X\",onExecute:function(evt){var scope=this.scope();var tc=scope['toggle-component'];if(tc.getState()!==true){tc.setState(true);tc.setTimeout(\"reload-execute\",function(){scope.refresh.execute(evt,scope['@this']);},200);}else{tc.setState(false);}}}),$i(\"ace\",{align:\"left\",width:750}),$(\"vcl/ui/Tabs#bottom-tabs\",{align:\"bottom\",classes:\"bottom inset\",autoSize:\"height\"},[$(\"vcl/ui/Tab\",{action:\"toggle-source\",text:locale(\"Source\"),control:\"ace\",groupIndex:-2,visible:\"always\"}),$(\"vcl/ui/Tab\",{action:\"toggle-component\",text:locale(\"Component\"),control:\"host\",groupIndex:-3,visible:\"always\"})]),$(\"vcl/ui/Tree\",\"tree\",{align:\"client\",visible:false,css:{padding:\"8px\",\"background-color\":\"#f0f0f0\",\"border-left\":\"1px solid silver\",\"border-right\":\"1px solid silver\"},onNodesNeeded:function(parent){var owner=this._owner;for(var i=0;i<5;++i){var node=new Node(owner);node.setText(i);node.setExpandable(true);node.setParent(parent||this);}}}),$(\"vcl/ui/Panel\",\"host\",{action:\"toggle-component\",align:\"client\",selected:\"never\",executesAction:false,classes:\"animated\",css:{\"background-color\":\"#f0f0f0\",\"border-left\":\"1px solid silver\",\"border-right\":\"1px solid silver\"}},[$(\"vcl/ui/Element\",{content:\"<h3 style='margin-top:10%;'><center>\"+\"Reload <small>&#x2318;+R</small> or Save <small>&#x2318;+S</small> to view the component here<br><small>(or just click here to Reload)</small><br><br><br>\"+\"</center></h3><p style='padding-left:16px;'>Other shortcuts that might come handy:<ul>\"+\"<li><b>&#x21E7;&#x2318;+S</b> toggles the Source tab</li>\"+\"<li><b>&#x21E7;&#x2318;+C</b> toggles the Component tab</li>\"+\"<li><b>&#x21E7;&#x2318;+X</b> toggles the Component tab and reloads upon show</li></ul></p>\",onClick:function(){this.scope().refresh.execute();}})])]);");
define("text!vcl-comps/devtools/Editor$/folder.js", "\"use devtools/Resources\";var Resources=require(\"devtools/Resources\");function allowResource(resource){return[\".git\",\".svn\",\".DS_Store\"].indexOf(resource.uri.split(\"/\").pop())===-1;}\nfunction sortResource(resource1,resource2){if(resource1.name.startsWith(\".\")&&!resource2.name.startsWith(\".\")){return-1;}\nif(resource2.name.startsWith(\".\")&&!resource1.name.startsWith(\".\")){return 1;}\nif(resource1.type===resource2.type){return resource1.name<resource2.name?-1:1;}\nif(resource1.type===\"Folder\")return-1;return 1;}\nfunction common(tab){var resource=tab.vars(\"resource\");tab.setCloseable(false);tab.on(\"dblclick\",function(){if(confirm(\"Are you sure you want to close this resource?\")===true){this.getControl().getForm().close();}});if(resource.uri.split(\"/\").pop().indexOf(\".\")===-1){tab.addClass(\"bold\");}}\n$([],{css:{\"[id$=-editors-tabs]\":\"border-top-color: transparent;\"},_onDispatchChildEvent:function(component,name,evt,f,args){if(name!==\"keyup\"){return;}\nvar tabs=this.down(\"#editors-tabs\");if(evt.ctrlKey===true&&evt.shiftKey===true){if(evt.keyCode===186){tabs.selectPrevious();}else if(evt.keyCode===222){tabs.selectNext();}else{}}else if(evt.ctrlKey===true){if(evt.keyCode===evt.KEY_PAGE_UP){tabs.selectPrevious();}else if(evt.keyCode===evt.KEY_PAGE_DOWN){tabs.selectNext();}}},onActivate:function(){this.qsa(\"vcl/ui/Tab[selected=true]\").each(tab=>tab.getControl().setFocus());return this.inherited(arguments);},onLoad:function(){var scope=this.scope();var uri=this.vars([\"resource.uri\",true]);var editor_needed=scope['editor-needed'];if(typeof uri===\"string\"&&!uri.startsWith(\"local:\")){Resources.list(uri).then(res=>res.filter(allowResource).sort(sortResource).forEach((resource,i)=>editor_needed.execute({resource:resource,selected:i===0})));}\nscope.save._onExecute=null;var tab=this.up(\"vcl/ui/Tab\");tab.emit(\"resource-loaded\");if(tab)tab.addClass(\"bold\");scope['add-resources'].execute(this.vars(\"resources\")||[]);},},[$i((\"menu-open\"),{}),$i((\"refresh\"),{enabled:false}),$i((\"evaluate\"),{enabled:false}),$i((\"format\"),{enabled:false}),$i((\"ace\"),{visible:false}),$(\"vcl/ui/Tabs\",(\"editors-tabs\"),{action:\"prompt-add-resource\",executesAction:\"onDblClick\",onNodeCreated(){this.up().readStorage(\"editors-tabs\",(state)=>{state&&state.selected&&this.getControl(state.selected).setSelected(true);});},onChange(newTab,oldTab){if(!newTab)return;this.up().writeStorage(\"editors-tabs\",{selected:newTab&&newTab.getIndex()});}}),$(\"vcl/Action\",(\"editor-needed\"),{on(evt){var scope=this.scope();evt.resource.uri=js.normalize(this.vars([\"resource.uri\"])+\"/\",evt.resource.uri);var tabs=scope['editors-tabs'];var tab=(tabs._controls||[]).find(_=>_.vars(\"resource.uri\")===evt.resource.uri);if(tab){if(evt.selected)tab.setSelected(true);return tab;}\nvar owner=this._owner;var editor_needed=this.up(\"devtools/Workspace<>:root\").down(\"#editor-needed\");tab=editor_needed.execute({parents:{container:owner,tab:tabs},resource:evt.resource,selected:evt.selected,owner:owner});if(evt.resource.type===\"Folder\"){tab.addClass(\"bold\");}\ntab.setCloseable(false);tab.on(\"dblclick\",function(){if(confirm(\"Do you want to close this resource?\")===true){this.getControl().getForm().close();}});return tab;}}),$(\"vcl/Action\",(\"prompt-add-resource\"),{onExecute(evt){console.log(evt.shiftKey,require(\"util/Event\").getKeyModifiers(evt));var editor_needed=this.up(\"devtools/Workspace<>:root\").down(\"#editor-needed\");var uri=this.vars([\"resource.uri\"]);var scope=this.scope();var owner=this._owner;app.prompt(\"Enter new resource uri:\",uri+\"/Resource-\"+Math.random().toString(36).substring(2,15),function(value){if(value){var tab=editor_needed.execute({parents:{container:owner,tab:scope['editors-tabs']},resource:{uri:value},selected:true,owner:owner});common(tab);}});}}),$(\"vcl/Action\",(\"add-resources\"),{onExecute:function(resources){var scope=this.scope(),app=this.app();var uri=this.vars([\"resource.uri\"]);var editor_needed=this.up(\"devtools/Workspace<>:root\").down(\"#editor-needed\");var editors=this.up(\"devtools/Workspace<>:root\").down(\"#editors\");resources=resources.map(function(resource){resource=typeof resource===\"string\"?{uri:resource}:js.mixIn(resource);return resource;});var folders=resources.filter(_=>_.uri.indexOf(\"/\")>=0).map(_=>_.uri.split(\"/\").shift());folders=folders.filter(function(path,index){return folders.indexOf(path)===index;});var tabs={};folders.forEach(function(folder_uri,i){var tab=editor_needed.execute({selected:i===0,resource:{uri:folder_uri,type:\"Folder\"},parents:{container:scope['@owner'],tab:scope['editors-tabs']}});tab.on(\"resource-loaded\",function(){var lresources=resources.filter(function(resource){return resource.uri.indexOf(folder_uri+\"/\")===0;}).map(function(resource){return js.mixIn(js.mixIn(resource),{uri:resource.uri.substring(resource.uri.indexOf(\"/\")+1)});});tab.down(\"#add-resources\").execute(lresources);app.print(\"resource-loaded\",this);});app.print(folder_uri,tab);common(tab);});resources.forEach(function(resource,i){if(resource.uri.split(\"/\").length===1){var tab=editor_needed.execute({parents:{container:scope['@owner'],tab:scope['editors-tabs']},resource:resource,selected:i===0&&!folders.length,owner:scope['@owner']});tab.on(\"resource-loaded\",function(){if(typeof resource.onGenerate===\"function\"){tab.down(\"#ace\").setValue(resource.onGenerate(tab));}});common(tab);}});}}),$(\"vcl/Action\",(\"add-resources-try\"),{onExecute:function(resources){var scope=this.scope(),app=this.app();var uri=this.vars([\"resource.uri\"])+\"/\";var editor_needed=this.up(\"devtools/Workspace<>:root\").down(\"#editor-needed\");var editors=this.up(\"devtools/Workspace<>:root\").down(\"#editors\");resources=resources.map(function(resource){resource=typeof resource===\"string\"?{uri:resource}:js.mixIn(resource);resource.uri=js.normalize(uri,resource.uri);return resource;});}})]);");
define("text!vcl-comps/devtools/Editor$/md.js", "\"use on, markdown\";var on=require(\"on\");var markdown=require(\"markdown\");function render(){var value=this.getValue();var impl;if((impl=this.vars(\"onGetRenderValue\"))){value=impl(value);}\nif((impl=this.vars(\"onRender\"))){return impl(value);}\nvar root=markdown.toHTMLTree(value);this.up().vars(\"root\",markdown.toHTMLTree(value));this.up().qsa(\"#output\").forEach(_=>{_.setContent(markdown.renderJsonML(root));_.update(function(){on(this.nodeNeeded().qsa(\"img\"),\"load\",function(img,r){img=this;r=window.devicePixelRatio||1;if(img.src.indexOf(\"?2x\")!==-1){img.style.width=img.naturalWidth/r+\"px\";}});this._node.qsa(\"img\").forEach(function(img){var r=window.devicePixelRatio>1?2:2;if(img.naturalWidth&&img.src.indexOf(\"?2x\")!==-1){img.style.width=img.naturalWidth/r+\"px\";}});}.bind(_));});}\nvar Handlers={\"#output onDblClick\":function(evt){if(evt.metaKey===true){this._node.qsa(\"img\").forEach(function(img){var r=window.devicePixelRatio>1?2:2;if(img.naturalWidth&&img.src.indexOf(\"?2x\")!==-1){img.style.width=img.naturalWidth/r+\"px\";}});}}};$([],{handlers:Handlers},[$i((\"evaluate\"),{onLoad(){this.vars(\"eval\",()=>this.vars([\"root\"]));return this.inherited(arguments);}}),$i((\"ace\"),{align:\"left\",width:475,action:\"toggle-source\",executesAction:\"none\",onChange:function(){this.setTimeout(\"render\",render.bind(this),750);}}),$(\"vcl/Action\",(\"toggle-source\"),{hotkey:\"Shift+MetaCtrl+S\",selected:\"state\",visible:\"state\",state:true,onLoad(){this.up().readStorage(\"source-visible\",(visible)=>{if(typeof visible===\"boolean\"){this.setState(visible);}else if(visible===undefined&&this.vars([\"resource.uri\"]).split(\"/\").pop()===\".md\"){this.setState(false);}});},onExecute(){this.setState(!this.getState());this.up().writeStorage(\"source-visible\",this.getState());}}),$(\"vcl/ui/Panel\",(\"output\"),{align:\"client\",css:{\"background-color\":\"#f0f0f0\",\"border-left\":\"1px solid silver\",\"border-right\":\"1px solid silver\",\"font-family\":\"times,-apple-system,BlinkMacSystemFont,'Segoe UI',Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol'\",\"font-size\":\"12pt\",padding:\"10px\",\"img:not(:hover)\":\"max-width: 75%;\",\"code\":\"border-radius:3px;font-size: 10pt;background-color:white;padding:2px;line-height:12pt;\",}})]);");
define("text!vcl-comps/devtools/Editor$/png.js", "[[\"devtools/Editor<image>\"]]");
define("text!blocks/prototypes/Console.js", "\"use js\";[\"vcl-ui:Console\",{handlers:{loaded(){}}}];");
define("text!vcl-comps/devtools/Editor$/blocks.js", "\"use blocks/Factory\";var Blocks=require(\"blocks/Blocks\");var Factory=require(\"blocks/Factory\");var styles={\"#host\":{\"&.full-width\":\"min-width: 100%;\",\"background-color\":\"#f0f0f0\",\"border-right\":\"1px solid silver\"},\"#ace\":{\"border-right\":\"1px solid silver\"}};var handlers={};function print(comp,msg,value){comp.up(\"devtools/Workspace<>:selected\").qsa(\"devtools/Console<> #console\").print(msg,value);}\n$([\"./Editor<js>\"],{css:styles,onLoad:function(){var tab=this.up(\"vcl/ui/Tab\");var scope=this.scope();var sourceUri=this.getVar(\"resource.uri\",true);var uri=sourceUri.split(\".\");var ext=uri.pop(),index;uri=uri.join(\".\").split(\"/\");if((index=uri.indexOf(\"cavalion-blocks\"))!==-1){if(uri.length>1&&uri[uri.length-1].endsWith(\"<>\")){var specializer=uri.pop(),p=uri.join(\"/\");uri=String.format(\"$HOME/%s<%s>\",p.substring(p.length-2),n);}\nuri=uri.join(\"/\");if((index=uri.indexOf(\"<>/\"))!==-1){uri=uri.substring(0,index+1)+uri.substring(index+3)+\">\";}\nif(uri.indexOf(\"$/\")!==-1){uri=uri.split(\"$\");uri=uri[0]+(\"<\"+uri.pop().substring(1)+\">\");}}else{uri=uri.join(\"/\");}\nif(uri.indexOf(\"-blocks/tools/\")!==-1){scope['toggle-source'].setState(false);scope.ace.hide();scope['toggle-component'].setState(true);}\nvar keys=Blocks.parseUri(this.up(\"devtools/Workspace<>\")._uri);uri=String.format(\"$HOME/%s\",uri);var PATH=\"/src/cavalion-blocks/\";if(uri.indexOf(PATH)!==-1){uri=\"$HOME/\"+uri.substring(uri.indexOf(PATH)+PATH.length);}\nsourceUri=String.format(\"$HOME/%s\",sourceUri);function f(){scope.instantiate.execute({uri:uri,sourceUri:sourceUri});}\ntab.on({\"resource-loaded\":f,\"resource-saved\":f});return this.inherited(arguments);},onResize:function(){this.setTimeout(\"alignControls\",32);}},[$i((\"evaluate\"),{onLoad(){this.vars(\"eval\",()=>this.ud(\"#instantiate\").vars(\"root\"));return this.inherited(arguments);}}),$((\"vcl/Action\"),\"instantiate\",{onExecute:function(evt){var scope=this.scope(),uri=evt.uri;var owner=scope['@owner'];if(!scope.host.isVisible()){return;}\nvar factory=new Factory(require,uri,evt.sourceUri);var root=scope.host.vars(\"root\");while(root){try{root&&root._owner===owner&&root.destroy();root=scope.host.getControls()[0];}catch(e){alert(e.message);console.error(e);scope.host.vars(\"root\",(root=null));}}\nfactory.load(scope.ace.getValue(),function(){try{root&&root._owner===owner&&root.destroy();root=factory.newInstance(owner,uri);scope.host.vars(\"root\",root);if(root instanceof require(\"vcl/Control\")){root.setParent(scope.host);}else{root.qsa(\":instanceOf(vcl/Control)\").forEach(function(c){if(c.getParentComponent()===root){c.setParent(scope.host);}});}}catch(e){alert(e.message);}},function(e){root&&root.show();if(e instanceof Error){console.error(e);alert(e.message);}});}}),$((\"vcl/Action\"),\"toggle-source\",{hotkey:\"Shift+MetaCtrl+S\",selected:\"state\",visible:\"state\",state:true,onExecute:function(){this.setState(!this.getState());}}),$((\"vcl/Action\"),\"toggle-component\",{hotkey:\"Shift+MetaCtrl+C\",selected:\"state\",visible:\"state\",state:false,onExecute:function(){this.setState(!this.getState());}}),$((\"vcl/Action\"),\"toggle-instantiate\",{hotkey:\"Shift+MetaCtrl+X\",onExecute:function(evt){var scope=this.scope();var tc=scope['toggle-component'];if(tc.getState()!==true){tc.setState(true);tc.setTimeout(\"reload-execute\",function(){scope.refresh.execute(evt,scope['@this']);},200);}else{tc.setState(false);}}}),$((\"vcl/Action\"),\"toggle-full-width\",{onExecute(){this.toggle();this.scope().host.toggleClass(\"full-width\");this.scope().host.toggleClass(\"full-width\");this.scope().host.toggleClass(\"full-width\");},state:false,selected:\"state\"}),$i(\"ace\",{align:\"left\",width:750}),$(\"vcl/ui/Tabs#bottom-tabs\",{align:\"bottom\",classes:\"bottom inset\",autoSize:\"height\"},[$(\"vcl/ui/Tab\",{action:\"toggle-source\",text:locale(\"Source\"),control:\"ace\",groupIndex:-2,visible:\"always\"}),$(\"vcl/ui/Tab\",{action:\"toggle-component\",text:locale(\"Component\"),control:\"host\",groupIndex:-3,visible:\"always\"}),$(\"vcl/ui/Tab\",{action:\"toggle-full-width\",classes:\"without-menu\",text:locale(\".full-width\"),groupIndex:-4,visible:\"always\"})]),$(\"vcl/ui/Panel\",\"host\",{action:\"toggle-component\",align:\"client\",selected:\"never\",executesAction:false,classes:\"animated\"},[$(\"vcl/ui/Element\",{content:\"<h3 style='margin-top:10%;'><center>\"+\"Reload <small>&#x2318;+R</small> or Save <small>&#x2318;+S</small> to view the component here<br><small>(or just click here to Reload)</small><br><br><br>\"+\"</center></h3><p style='padding-left:16px;'>Other shortcuts that might come handy:<ul>\"+\"<li><b>&#x21E7;&#x2318;+S</b> toggles the Source tab</li>\"+\"<li><b>&#x21E7;&#x2318;+C</b> toggles the Component tab</li>\"+\"<li><b>&#x21E7;&#x2318;+X</b> toggles the Component tab and reloads upon show</li></ul></p>\",onClick:function(){this.scope().refresh.execute();}})])]);");
define("text!vcl-comps/veldoffice/Session.js", "\"use veldoffice/Session\";var Session=require(\"veldoffice/Session\");var handlers={onLoad:function(){this.scope().refresh.execute();}};var styles={\"\":\"background-color:white; font-family: Lucida Grande, Arial, sans-serif, -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', HelveticaNeue, Helvetica, Arial, sans-serif;white-space:nowrap;padding-left:20px;padding-right:20px;\",\"input\":\"margin: 2px; font-size: 10pt; border-radius: 15px; border: none;padding: 4px 10px; width:33%;display:inline-block;background-color:#f0f0f0;\",\"i.fa\":\"font-size:14pt;\",\"button\":\"border:1px solid gray;margin:3px;border-radius:5px;width:auto;\",\"#title\":\"font-family:Lucida Grande,Arial,sans-serif;font-weight:600;font-size:17pt;_letter-spacing:0.75px;\",\"#switcher\":\"padding-left:10px;font-weight:400;font-size:14pt;color:rgb(0,136,255);\"};$(\"vcl-ui/Bar\",{css:styles,handlers:handlers},[$(\"vcl/Action\",\"refresh\",{content:locale(\"Refresh\"),onExecute:function(){var scope=this.scope(),me=this;scope.login.setVisible(false);scope.logout.setVisible(false);scope.status.setContent(locale(\"Session.refreshing\"));this.setVisible(true);this.setEnabled(false);Session.refresh().then(function(){me.setEnabled(true);if(Session.isAuthenticated()){scope.login.setVisible(false);scope.logout.setVisible(true);Session.info().then(function(resp){resp=resp||Session.info_;scope.status.setContent(String.format(\"<div><b>%H</b></div>%H\",resp.name,resp.bedrijf.naam,locale(\"Session.authenticated\")));});}else{scope.login.setVisible(true);scope.logout.setVisible(false);scope.status.setContent(locale(\"Session.unauthenticated\"));}});}}),$(\"vcl/Action\",\"login\",{visible:false,content:locale(\"Login\"),onExecute:function(){var scope=this.scope(),me=this;this.setVisible(false);scope.status.setContent(locale(\"Session.working\"));Session.login(scope.username.getValue()||\"ralph@veldapps.com\",scope.password.getValue()).then(function(resp){if(resp.success===false){alert(resp.message);}\nscope.refresh.execute();});}}),$(\"vcl/Action\",\"logout\",{visible:false,content:locale(\"Logout\"),onExecute:function(){var scope=this.scope(),me=this;this.setEnabled(false);scope.status.setContent(locale(\"Session.working\"));Session.logout().then(function(){me.setEnabled(true);scope.refresh.execute();}).catch(function(){me.setEnabled(true);scope.refresh.execute();});}}),$(\"vcl-ui/Group\",{css:\"float:left;\"},[$(\"vcl-ui/Element\",\"title\",{content:\"Veldoffice<span style='font-weight:normal;'></span>\"}),]),$(\"vcl-ui/Element\",\"status\",{action:\"refresh\",css:\"text-align:right;font-size:10pt;\"}),$(\"vcl-ui/Group\",{css:\"float:right;text-align:right;\"},[$(\"vcl-ui/Input\",\"username\",{action:\"login\",executesAction:\"none\",placeholder:\"Username\"}),$(\"vcl-ui/Input\",\"password\",{action:\"login\",executesAction:\"none\",placeholder:\"Password\",type:\"password\"}),$(\"vcl-ui/Button\",{action:\"login\"}),])]);");
define("text!vcl-comps/devtools/Editor$/xsd.js", "var XSD_NS=\"http://www.w3.org/2001/XMLSchema\";var XS_NAMESPACE_PREFIXES=['','xs:','xsd:'];var at__=\"@__\";var sf=String.format;function asArray(arr){if(arr===null||arr===undefined)return[];if(!(arr instanceof Array))return[arr];return arr;}\nfunction xsArray(path,obj){var r=[];path=path.split(\".\");XS_NAMESPACE_PREFIXES.forEach(function(ns){var namePath=sf(\"%s%s\",ns,path.join(\".\"+ns));r=r.concat(asArray(js.get(namePath,obj)));});return r;}\nfunction js_getXs(path,elem){var r;XS_NAMESPACE_PREFIXES.some(function(prefix){var namePath=path.split(\".\").map(part=>js.sf(part,prefix)).join(\".\");r=r||js.get(namePath,elem);});return r;}\nfunction onDblClick(){var console=this.up(\"devtools/Workspace<>\").down(\"vcl/ui/Console#console\");this.getSelection(true).map(_=>console.print(_.__name||_['@_name']||_.name,_));}\nfunction resolveUri(uri,me){var url_map=me.vars([\"devtools/Editor<xsd>/url_map\"])||{};var v=url_map[uri];if(v){return v;}\nif(uri.indexOf(\"https://schema.broservices.nl/\")===0){uri=\"Library/schema.broservices.nl/\"+uri.substring(\"https://schema.broservices.nl/\".length);}else if(uri.indexOf(\"http://schemas.opengis.net/\")===0){uri=\"Library/opengis.net/\"+uri.substring(\"http://schemas.opengis.net/\".length);}else if(uri.indexOf(\"http://www.w3.org/1999/\")===0||uri.indexOf(\"http://www.w3.org/2001/\")===0){uri=\"Library/opengis.net/\"+uri.substring(\"http://www.w3.org/1999/\".length);}else if(uri.indexOf(\"/\")===-1){uri=js.up(me.vars([\"resource.uri\",true]))+\"/\"+uri;}\nreturn uri;}\nfunction parserNeeded(workspace,uri,callback,once){var tab=workspace.qs(\"#editor-needed\").execute({dontBringToFront:true,resource:{uri:uri}});var parser=tab.qs(\":root\");if(parser&&(parser=parser.vars(\"parser\"))){callback(parser);}else{tab[!once?\"on\":\"once\"](\"resource-rendered\",function(){parserNeeded(workspace,uri,callback,once);});}}\nvar xsTypes={};[\"ID\",\"anyType\",\"anyURI\",\"boolean\",\"complexContent/extension\",\"date\",\"dateTime\",\"decimal\",\"double\",\"duration\",\"integer\",\"nonNegativeInteger\",\"positiveInteger\",\"string\",\"time\",\"xs:anyURI\",\"xs:boolean\",\"xs:dateTime\",\"xs:decimal\",\"xs:double\",\"xs:duration\",\"xs:integer\",\"xs:string\"].map(_=>(xsTypes[_]={xstype:_}));$([\"devtools/Editor<xml>\"],{handlers:{\"loaded\":function(){var tab=this.up(\"vcl/ui/Tab\"),scope=this.scope();tab.on(\"resource-loaded\",function(){scope.render.setTimeout(\"execute\",500);});},\"#elements onDblClick\":onDblClick,\"#complexTypes onDblClick\":onDblClick,\"#simpleTypes onDblClick\":onDblClick,\"#attributes onDblClick\":onDblClick,\"#imports onDblClick\":function(evt){var action=this.up(\"devtools/Workspace<>\").down(\"#editor-needed\");var me=this;evt=evt||{};this.getSelection(true).forEach(function(imp){var uri=resolveUri(imp['@_schemaLocation'],me);var tab=action.execute({dontBringToFront:evt.altKey!==false,selected:evt.altKey===true,resource:{uri:uri}});var root=tab._control.down(\":root\");if(!root){me.up(\"devtools/Workspace<>\").down(\"devtools/OpenTabs<>\").dispatch(\"activate\",{});}});},\"#search-input onChange\":function(){var me=this,scope=me.scope();function filter(object){var values=me.getInputValue().toLowerCase().trim().split(\" \");var or=values.some(function(value){return Object.keys(object).some(function(key){return(\"\"+object[key]).toLowerCase().indexOf(value)!==-1;});});var and=values.every(function(value){return Object.keys(object).some(function(key){return(\"\"+object[key]).toLowerCase().indexOf(value)!==-1;});});return!and;}\nthis.setTimeout(\"change\",function(){var value=me.getInputValue();scope.stypes.setOnFilterObject(!value.length?null:filter);scope.ctypes.setOnFilterObject(!value.length?null:filter);scope.elems.setOnFilterObject(!value.length?null:filter);scope.attrs.setOnFilterObject(!value.length?null:filter);scope.stars.setOnFilterObject(!value.length?null:filter);},200);}}},[$i((\"render\"),{onExecute(){var r=this.inherited(arguments);var app=this.app(),scope=this.scope(),me=this;var resource=this.vars([\"resource\",true]);var workspace=this.up(\"devtools/Workspace<>:root\");var schema_id=resource.uri.split(\"/\").splice(2).join(\"/\");var root=this.vars([\"root\"]),schema,ns_prefix;XS_NAMESPACE_PREFIXES.some(function(prefix){ns_prefix=prefix;schema=root[ns_prefix+\"schema\"];return root.hasOwnProperty(prefix+\"schema\");});var xmlns={};schema&&Object.keys(schema).forEach(function(key){if(key.indexOf('@_xmlns:')===0){xmlns[key.split(\":\").pop()]=schema[key];if(schema['@_targetNamespace']===schema[key]){xmlns['']=key.split(\":\").pop();}}});var parser={root:root,xmlns:xmlns,schema:schema_id,ns_prefix:ns_prefix,included_stypes:{},included_ctypes:{},included_elems:{},included_groups:{},included_imps:{},included_attrs:{},included_agroups:{},stamp:function(xsel){if(!js.get(at__+\".parser\",xsel)){js.set(at__+\".parser\",this,xsel);}\nif(!js.get(at__+\".schema\",xsel)){js.set(at__+\".schema\",schema_id,xsel);}\nif(!js.get(at__+\".xmlns\",xsel)){js.set(at__+\".xmlns\",xmlns[''],xsel);}},imps:xsArray(\"import\",schema).concat(xsArray(\"schema.include\",root).map(function(include){include['@_namespace']=schema['@_targetNamespace'];js.set(at__+\".include\",true,include);return include;})),stars:[],attrs:xsArray(\"attribute\",schema),elems:xsArray(\"element\",schema),ctypes:xsArray(\"complexType\",schema),stypes:xsArray(\"simpleType\",schema),groups:xsArray(\"group\",schema),agroups:xsArray(\"attributeGroup\",schema),elems_map:workspace.vars(\"devtools/Editor<xsd>/elems_map\",false,{}),attrs_map:workspace.vars(\"devtools/Editor<xsd>/attrs_map\",false,{}),ctypes_map:workspace.vars(\"devtools/Editor<xsd>/ctypes_map\",false,{}),stypes_map:workspace.vars(\"devtools/Editor<xsd>/stypes_map\",false,{}),groups_map:workspace.vars(\"devtools/Editor<xsd>/groups_map\",false,{}),agroups_map:workspace.vars(\"devtools/Editor<xsd>/agroups_map\",false,{}),log:function(elem,msg){if(msg instanceof Array){scope.console.print(msg[0],msg.splice(1));}else{scope.console.print(msg,elem);}\n(elem[at__].messages=elem[at__].messages||[]).push(msg);},parse:function(){this.stypes.forEach(this.parseSimpleType,this);this.ctypes.forEach(this.parseComplexType,this);this.agroups.forEach(this.parseAttributeGroup,this);this.groups.forEach(this.parseGroup,this);this.imps.forEach(this.parseImport,this);this.attrs.forEach(this.parseAttribute,this);this.elems.forEach(this.parseElement,this);this.elems.forEach(function(elem){var at=elem[at__];for(var k in at.features){var attribute=at.features[k];this.stars.push({xmlns:at.xmlns,namespace:attribute.namespace,namespace_type:attribute.namespace_type,name:k,element:elem['@_name'],kind:attribute.kind,type:attribute.type,schema:at.schema,attribute:attribute});}},this);this.ctypes.forEach(function(ctype){var at=ctype[at__];for(var k in at.features){var attribute=at.features[k];this.stars.push({xmlns:at.xmlns,namespace:attribute.namespace,namespace_type:attribute.namespace_type,name:k,complexType:ctype['@_name'],kind:attribute.kind,type:attribute.type,schema:at.schema,attribute:attribute});}},this);},findType:function(name){return this.ctypes_map[name]||this.stypes_map[name]||xsTypes[name];},findGroup:function(name){return this.groups_map[name];},findAttributeGroup:function(name){return this.agroups_map[name];},findElement:function(name){return this.elems_map[name];},parseImport:function(xselem){this.stamp(xselem);var uri=resolveUri(xselem['@_schemaLocation'],me);xselem[at__].uri=uri;this.inheritImport(xselem,uri,parser);},parseSimpleType:function(xselem,i){this.stypes_map[xmlns['']+\":\"+xselem['@_name']]=xselem;this.stamp(xselem);},parseAttributeGroup:function(xselem,i){this.agroups_map[xmlns['']+\":\"+xselem['@_name']]=xselem;this.stamp(xselem);this.inheritAttributeGroup(xselem,xselem,xselem['@_name']);this.stamp(xselem);this.inheritAttributeGroup(xselem,xselem,\"root\");},parseGroup:function(xselem,i){this.groups_map[xmlns['']+\":\"+xselem['@_name']]=xselem;this.stamp(xselem);this.inheritGroup(xselem,xselem,xselem['@_name']);this.stamp(xselem);this.inheritGroup(xselem,xselem,\"root\");},parseComplexType:function(xselem,i){this.ctypes_map[xmlns['']+\":\"+xselem['@_name']]=xselem;this.stamp(xselem);this.inheritType(xselem,xselem,xselem['@_name']);},parseElement:function(xselem,i){this.elems_map[xmlns['']+\":\"+xselem['@_name']]=xselem;this.stamp(xselem);var base,type,ref;if(xselem['@_base']){me.print(\"parseElement.@_base\",xselem);throw new Error(\"Unexpected\");}else if(xselem['@_type']){if((type=this.findType(xselem['@_type']))){js.set(at__+\".type-resolved\",type,xselem);this.inheritType(xselem,type,xselem['@_type']);}else{this.log(xselem,sf(\"@_type %s not found (291)\",xselem['@_type']));}}else if(xselem[sf(\"%scomplexType\",ns_prefix)]){this.inheritType(xselem,xselem[sf(\"%scomplexType\",ns_prefix)],\"inline?\");}else{me.print(\"parseElement.notHandled\",xselem);}},parseAttribute:function(xselem,i){this.attrs_map[xmlns['']+\":\"+xselem['@_name']]=xselem;this.stamp(xselem);this.inheritAttribute(xselem,xselem,\"root\");},inheritImport:function(xselem,uri,parser){if(js.get(at__+\".include\",xselem)===true){[\"stypes\",\"ctypes\",\"groups\",\"elems\",\"attrs\"].map(function(key){this[\"included_\"+key][uri]=[].concat(parser[key]);},this);me.up().setTimeout(\"refresh\",function(){this.reflect();}.bind(this),200);}},inheritType:function(xselem,xstype,xstype_name,as_base){var base;if(xstype['@_base']){if((base=this.findType(xstype['@_base']))){js.set(at__+\".base-resolved\",base,xstype);this.inheritType(xselem,base,xstype_name);}else{this.log(xselem,sf(\"@_base %s not found\",xstype['@_base']));}}\nif(xstype['@_ref']){console.log(\"inheritType.@_ref\",xselem,xstype);}\nif(xstype['@_substitutionGroup']){console.log(\"inheritType.@_substitutionGroup\",xselem,xstype);}\nxsArray(\"simpleContent.extension\",xstype).map(function(xsext,i){this.stamp(xsext);this.inheritType(xselem,xsext,\"simpleContent/extension\");},this);xsArray(\"complexContent.extension\",xstype).map(function(xsext,i){this.stamp(xsext);this.inheritType(xselem,xsext,\"complexContent/extension\");},this);xsArray(\"attribute\",xstype).map(function(xsattr,i){this.stamp(xsattr);this.inheritAttribute(xselem,xsattr,xstype_name);},this);xsArray(\"attributeGroup\",xstype).map(function(xsattributegroup,i){this.stamp(xsattributegroup);this.inheritAttributeGroup(xselem,xsattributegroup,xstype_name);},this);xsArray(\"sequence.group\",xstype).map(function(xsgroup,i){this.stamp(xsgroup);this.inheritGroup(xselem,xsgroup,xstype_name);},this);xsArray(\"sequence.attributeGroup\",xstype).map(function(xsattributegroup,i){this.stamp(xsattributegroup);this.inheritAttributeGroup(xselem,xsattributegroup,xstype_name);},this);xsArray(\"sequence.element\",xstype).map(function(xsel,i){this.stamp(xsel);this.inheritElement(xselem,xsel,xsel['@_type']);},this);xsArray(\"choice.element\",xstype).map(function(xsel,i){this.stamp(xsel);this.inheritElement(xselem,xsel,xsel['@_type']);},this);xsArray(\"sequence.sequence.element\",xstype).map(function(xsel,i){this.stamp(xsel);this.inheritElement(xselem,xsel,xstype_name);},this);},inheritAttribute:function(xselem,xsattribute,xsattribute_name){var ref=xsattribute['@_ref'],type;var name=xsattribute['@_name']||ref;if(ref){if(!(type=this.attrs_map[ref])){this.log(xselem,sf(\"@_ref %s not found\",ref));}}else if(xsattribute.xs){this.log(xselem,\">>> xsattribute.xs\")\nif((type=js_getXs(\"%scomplexType.%ssimpleContent.%srestriction.@_base\",xsattribute))){}\nthis.log(xselem,[\"not understood\",xsattribute,xsattribute_name]);}else{if(!(type=this.findType(xsattribute['@_type']||xsattribute_name))){this.log(xselem,sf(\"@_type .%s. not found (380)\",xsattribute['@_type']||xsattribute_name));}}\nvar info,x;js.set(at__+\".features.\"+name,(info={namespace:xsattribute[at__].xmlns,reference:!!ref,kind:\"attribute\",type:ref||xsattribute['@_type']||xsattribute_name,'type-resolved':type,cardinality:[typeof(x=xsattribute['@_minOccurs'])===\"number\"?x:x||1,typeof(x=xsattribute['@_maxOccurs'])===\"number\"?x:x||1].join(\"-\"),xs:xsattribute}),xselem);if(info['type-resolved']){info.namespace_type=js.get(sf(\"type-resolved.%s.xmlns\",at__),info);}},inheritElement:function(xselem,xsel,xsel_name){var ref=xsel['@_ref'],name=xsel['@_name']||ref;var info={namespace:xsel[at__].xmlns,kind:\"element\",type:xsel_name,cardinality:[typeof(x=xsel['@_minOccurs'])===\"number\"?x:x||1,typeof(x=xsel['@_maxOccurs'])===\"number\"?x:x||1].join(\"-\"),xs:xsel};if(ref){info.type=ref;info.reference=true;if(!(info['type-resolved']=this.elems_map[ref])){this.log(xselem,sf(\"@_ref %s not found\",ref));}}else if((type=js_getXs(\"%scomplexType\",xsel))){}else if(!(info['type-resolved']=this.findType(info.type))){this.log(xselem,sf(\"type %s not found (415)\",info.type||name));}\nif(info['type-resolved']){info.namespace_type=js.get(sf(\"type-resolved.%s.xmlns\",at__),info);}\njs.set(at__+\".features.\"+name,info,xselem);},inheritGroup:function(xselem,xsgroup,xsgroup_name){var ref;if(xsgroup['@_ref']){if((ref=this.findGroup(xsgroup['@_ref']))){js.set(at__+\".ref-resolved\",ref,xsgroup);this.inheritType(xselem,ref,xsgroup['@_ref']);}else{this.log(xselem,sf(\"@_ref %s not found\",xsgroup['@_ref']));}}},inheritAttributeGroup:function(xselem,xsattributegroup,xsattributegroup_name){var ref;if((ref=xsattributegroup['@_ref'])){if((ref=this.findAttributeGroup(ref))){js.set(at__+\".ref-resolved\",ref,xsattributegroup);this.inheritAttributeGroup(xselem,ref,xsattributegroup['@_ref']);}else{this.log(xselem,sf(\"@_ref %s not found\",xsattributegroup['@_ref']));}}\nxsArray(\"attributeGroup\",xsattributegroup).map(function(xsattrgroup,i){this.stamp(xsattrgroup);this.inheritAttributeGroup(xselem,xsattrgroup,xsattrgroup['@ref']);},this);[\"\",\"xs:\",\"xsd:\"].map(function(ns_prefix){xsArray(\"attribute\",xsattributegroup).map(function(xsattr,i){this.stamp(xsattr);this.inheritAttribute(xselem,xsattr,xsattr['@_name']);},this);},this);},reflect:function(){var me=this;function sort_name(i1,i2){return i1['@_name']<i2['@_name']?-1:1;}\n[\"stypes\",\"ctypes\",\"groups\",\"agroups\",\"elems\",\"attrs\",\"stars\"].map(function(key){var included=[];for(var k in me[\"included_\"+key]){included=included.concat(me[\"included_\"+key][k]);}\nscope[key].setArray(me[key].concat(included).sort(sort_name));});scope.imps.setArray(this.imps);}};parser.parse();parser.reflect();var sorted=[].concat(scope.elements._columns).sort(function(c1,c2){return c1._attribute<c2._attribute?-1:1;});scope.elements._columns.forEach(function(col){col.setIndex(sorted.indexOf(col));});scope.console.print(\"parser\",parser);this.up(\":root\").vars(\"parser\",parser);this.up(\"vcl/ui/Tab\").emit(\"resource-rendered\",[this]);return r;}}),$((\"vcl/data/Array\"),\"imps\"),$((\"vcl/data/Array\"),\"stars\"),$((\"vcl/data/Array\"),\"attrs\"),$((\"vcl/data/Array\"),\"groups\"),$((\"vcl/data/Array\"),\"agroups\"),$((\"vcl/data/Array\"),\"elems\"),$((\"vcl/data/Array\"),\"ctypes\"),$((\"vcl/data/Array\"),\"stypes\"),$i((\"output\"),[$((\"vcl/ui/Bar\"),[$(\"vcl/ui/Input\",\"search-input\",{classes:\"search-top\"}),]),$i((\"tabs\"),[$(\"vcl/ui/Tab\",{text:locale(\"-/Import.plural\"),control:\"imports\"}),$(\"vcl/ui/Tab\",{text:\"*\"||locale(\"-/Star.symbol\"),control:\"allstars\"}),$(\"vcl/ui/Tab\",{text:locale(\"-/Attribute.plural\"),control:\"attributes\"}),$(\"vcl/ui/Tab\",{text:locale(\"-/Element.plural\"),control:\"elements\"}),$(\"vcl/ui/Tab\",{text:locale(\"-/ComplexType.plural\"),control:\"complexTypes\"}),$(\"vcl/ui/Tab\",{text:locale(\"-/Group.plural\"),control:\"groupsl\"}),$(\"vcl/ui/Tab\",{text:locale(\"-/SimpleType.plural\"),control:\"simpleTypes\"}),$(\"vcl/ui/Tab\",{text:locale(\"-/AttributeGroup.plural\"),control:\"attributeGroups\"})]),$i((\"console\"),{visible:false}),$(\"vcl/ui/List\",\"imports\",{autoColumns:true,source:\"imps\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"allstars\",{autoColumns:true,source:\"stars\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"attributes\",{autoColumns:true,source:\"attrs\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"elements\",{autoColumns:true,source:\"elems\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"complexTypes\",{autoColumns:true,source:\"ctypes\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"groupsl\",{autoColumns:true,source:\"groups\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"attributeGroups\",{autoColumns:true,source:\"agroups\",visible:false,onDblClick:onDblClick}),$(\"vcl/ui/List\",\"simpleTypes\",{autoColumns:true,source:\"stypes\",visible:false,onDblClick:onDblClick})])]);");
define("text!vcl-comps/devtools/App$/code.js", "$([],{onLoad(){this.setTimeout(()=>{this.print(this._uri,this)},250);return this.inherited(arguments);}},[]);");
define("text!vcl-comps/devtools/Main$/code.js", "[[\"./Main<Cavalion-code>\"]];");
define("text!vcl-comps/devtools/Editor$/xml.js", "\"use fast-xml-parser, xml-funcs, veldapps-imsikb/util\";function match(obj,q){q=q.toLowerCase();for(var k in obj){var v=obj[k];if(!(v instanceof Array)){v=[v];}\nif(v.some(obj=>js.sf(\"%n\",obj).toLowerCase().includes(q))){return true;}}\nreturn false;}\nvar Blocks=require(\"blocks\");var Parser=require(\"fast-xml-parser\");var Xml=require(\"xml-funcs\");var DetailViews={imsikb0101:[\"Container\",{css:{\"#bar > *\":\"margin-right:5px;\",\"#bar input\":\"border-radius: 5px; border-width: 1px; padding: 2px 4px; border-color: #f0f0f0;\"},onLoad(){var root=this.vars(\"root\");var parsed=require(\"veldapps-imsikb/util\").parse(root);var tabs=[];for(var ent in parsed.entities){tabs.push([\"Tab\",{textReflects:\"innerHTML\",text:js.sf(\"%H <small>(%d)</small>\",ent.split(\":\").pop(),parsed.entities[ent].length),vars:{array:parsed.entities[ent]}}]);}\nif(tabs.length){B.i([\"Container\",tabs]).then(c=>{var tabs=this.scope().tabs;tabs.clearState(\"acceptChildNodes\");[].concat(c._controls).forEach(tab=>tab.setParent(tabs));tabs.setState(\"acceptChildNodes\",true);tabs._controls[0].setSelected(true);});}},visible:false,vars:{selected:true}},[[\"Array\",(\"array\"),{onFilterObject(obj){var q=this.vars(\"q\");if(!q)return false;return q.split(/\\s/).filter(q=>q.length>0).some(q=>!match(obj,q));}}],[\"Bar\",(\"bar\"),{css:{\"\":\"text-align: center;\",\"input\":\"width: 250px; font-size: 14pt;\"}},[[\"Input\",(\"q\"),{placeholder:\"Filter\",onChange(){var array=this.ud(\"#array\");this.setTimeout(\"updateFilter\",()=>{array.vars(\"q\",this.getValue());array.updateFilter();},250);}}],[\"Radiobutton\",(\"opt-and\"),{visible:false,label:\"AND\",groupIndex:1}],[\"Radiobutton\",(\"opt-or\"),{visible:false,checked:true,groupIndex:1,label:\"OR\"}],[\"Checkbox\",(\"check-exact-case\"),{visible:false,label:\"Exact case\",checked:false}]]],[\"List\",(\"list\"),{css:{\".ListCell\":\"color:red;\"},autoColumns:true,source:\"array\",css:\"background-color:white;\",onDblClick(){var selection=this.getSelection(true);this.print(selection.length===1?selection[0]:selection);}}],[\"Ace\",(\"ace\"),{visible:false}],[\"Tabs\",(\"tabs\"),{css:\"text-align:center;\",onChange(newTab,oldTab){var list=this.scope().list;var n=list.nodeNeeded();if(oldTab!==null){oldTab.vars(\"scrollInfo\",[n.scrollLeft,n.scrollTop]);console.log(\"scrollInfo\",oldTab.vars().scrollInfo);}\nthis.ud(\"#array\").setArray([]);this.setTimeout(\"change\",()=>{if(newTab!==null){var n=this.ud(\"#list\").nodeNeeded();this.ud(\"#array\").setArray(newTab.vars(\"array\"));this.setTimeout(\"change\",()=>{var si=newTab.vars(\"scrollInfo\");si&&(n.scrollLeft=si[0]);si&&(n.scrollTop=si[1]);},200);}},50);}}]]]};[\"\",{css:{\"#output\":\"background-color: #f0f0f0; border-right: 1px solid silver;\"},onLoad(){var render=(evt)=>this.qsa(\"#render\").execute(evt);this.up(\"vcl/ui/Tab\").on({\"resource-loaded\":render,\"resource-saved\":render});return this.inherited(arguments);}},[[\"vcl/Action\",(\"toggle-source\"),{hotkey:\"Shift+MetaCtrl+S\",selected:\"state\",visible:\"state\",state:true,onExecute:function(){this.setState(!this.getState());}}],[\"vcl/Action\",(\"toggle-output\"),{hotkey:\"Shift+MetaCtrl+O\",selected:\"state\",visible:\"state\",state:true,onExecute:function(){var output=this.scope().output;output.setVisible(!output.isVisible());}}],[\"vcl/Action\",(\"render\"),{onExecute:function(){var owner=this._owner;var scope=this.scope();var root=Parser.parse(scope.ace.getValue(),{ignoreAttributes:false});var format,formats=[];var console=scope.console;console.print(\"root\",owner.vars(\"root\",root));if(root.hasOwnProperty(\"imsikb0101:FeatureCollectionIMSIKB0101\")){formats.push(\"imsikb0101\");format=formats[0];}\nif(formats.length){console.print(\"formats detected\",formats.join(\", \"));this.setTimeout(\"load-detailviews\",()=>{var dva=this.ud(\"#detailview-available\");console.print(\"loading extensions\",Promise.all(formats.map(format=>Blocks.instantiate(DetailViews[format],{setIsRoot:true,loaded(view){view.vars(\"root\",root);view.loaded();}}).then(view=>{view.setOwner(owner);dva.execute({name:format,view:view,selected:view.vars(\"selected\")});return view;}))));},500);}}}],[\"vcl/Action\",(\"detailview-available\"),{on(evt){var Tab=require(\"vcl/ui/Tab\");var scope=this.scope();var tab=new Tab({owner:this._owner,text:evt.name,parent:scope['details-tabs'],control:evt.view,selected:evt.selected||false});evt.view.setParent(scope.output);return tab;}}],[\"vcl/ui/Panel\",(\"output\"),{align:\"client\"},[[\"vcl/ui/Tabs\",(\"details-tabs\"),{align:\"bottom\",classes:\"bottom\"},[[\"vcl/ui/Tab\",{text:locale(\"Console\"),control:\"console\",selected:true}]]],[\"vcl/ui/Console\",(\"console\"),{align:\"client\",vars:{'skip-print':true},onEvaluate:function(expr){var root=this._owner.getVar(\"root\"),scope=this.scope();return eval(expr);}}]]],[(\"#render\"),{on(){this.inherited(arguments);}}],[(\"#ace\"),{align:\"left\",width:600,action:\"toggle-source\",executesAction:\"none\"}],[(\"#evaluate\"),{onLoad(){this.vars(\"eval\",()=>this.vars([\"root\"]));return this.inherited(arguments);}}]]];");
define("text!vcl-comps/devtools/Main$/Cavalion-code.js", "\"use blocks\";[\"\",{vars:{\"default-workspaces\":[{name:\"⌘1\",selected:true},{name:\"⌘2\"},{name:\"⌘3\"},{name:\"⌘4\"}]}},[]];");
define("text!vcl-comps/devtools/Workspace$/code.js", "var db=require(\"vcl/Component\").storageDB.name;$([],{vars:{\"#navigator favorites\":[\"Workspaces/cavalion.org/cavalion-ide/src/cavalion-blocks\",\"Workspaces/cavalion.org/cavalion-code/src\",\"Workspaces/cavalion.org/cavalion-code/src/vcl-comps\",\"Workspaces/cavalion.org/cavalion-code/CHANGELOG.md;CHANGELOG.md;File\",\"Workspaces/cavalion.org/cavalion-code/ROADMAP.md;ROADMAP.md;File\",\"Workspaces/cavalion.org/cavalion-code/src/cavalion-blocks/tools/devtools;_tools/devtools;Folder\",js.sf(\"pouchdb://%s;%s/;Folder;seperator\",db,db)],\"additional-workspaces\":[\"build\"]},handlers:{loaded:function(){var keys=require(\"vcl/Component\").getKeysByUri;if(keys(this._uri).specializer_classes.length>0){return;}\n{var this_index=this.up(\"vcl/ui/Tab\").getIndex(),tab;this.udown(\"#workspace-needed\").execute({workspace:{name:\"code/build\",selected:false}}).setIndex(this_index);}}}});");
define("text!vcl/prototypes/App.js", "$(\"vcl/Application\",{onLoad:function(){var img=document.body.childNodes[0];if(img.nodeName===\"IMG\"){img.parentNode.removeChild(img);}\nvar scope=this.scope(),delegate;scope.window.setParentNode(this.isDesigning()?scope.window.getDesigner().getParentNode():document.body);}},[$(\"vcl/ui/Panel\",\"window\",{align:\"client\",classes:\"animated\",css:{\"font-family\":\"Lucida Grande, Arial, sans-serif\",\"font-size\":\"9pt\",\".{./Button}\":{\"font-family\":\"Lucida Grande, Arial, sans-serif\",\"font-size\":\"9pt\"}}},[])]);");
define("text!vcl-comps/ui/forms/util/Console.js", "\"use vcl/Component\";var Component=require(\"vcl/Component\");function setPaths(){localStorage.setItem(\"cavalion-js-path\",\"/home/Workspaces/cavalion.org/cavalion-js/src/\");localStorage.setItem(\"cavalion-vcl-path\",\"/home/Workspaces/cavalion.org/cavalion-vcl/src/\");localStorage.setItem(\"cavalion-blocks-path\",\"/home/Workspaces/cavalion.org/cavalion-blocks/src/\");localStorage.setItem(\"cavalion-devtools-path\",\"/home/Workspaces/cavalion.org/cavalion-devtools/src/\");localStorage.setItem(\"cavalion-ide-path\",\"/home/Workspaces/cavalion.org/cavalion-ide/src/\");localStorage.setItem(\"veldoffice-js-path\",\"/home/Workspaces/veldapps.com/veldoffice-js/src/\");localStorage.setItem(\"veldapps-v7-path\",\"/home/Workspaces/veldapps.com/V7/src/\");}\nfunction edit(component){var uri=component&&component._uri;var app=component&&component.app();if(typeof uri===\"string\"&&uri.indexOf(\"devtools/Workspace<\")===0){var keys=Component.getKeysByUri(uri);return component.app().open(\"code\").then(function(workspace){return workspace.open(\"Workspaces/cavalion.org/cavalion-devtools/src/vcl-comps/devtools/Workspace$/\"+keys.specializer+\".js\");});}}\n$([],{},[$i(\"console\",{onEvaluate:function(expr){var scope=this.scope(),me=this;var app=this.app();var ws=app.down(\"devtools/Workspace<>:root:selected:visible\");var ace=ws&&ws.qsa(\"devtools/Editor<>:root:visible #ace\").pop();var host=ws&&ws.qsa(\"devtools/Editor<>:root:visible #host\").pop();var root=ace&&ace.up().down(\":root\");var pr=this.print.bind(this);function open(uri,opts){me.bubble(\"openform\",js.mixIn(js.mixIn(opts||{}),{uri:uri}));}\nreturn eval(expr);}})]);");
define("text!vcl/prototypes/ui/forms/util/Console.js", "\"vcl/Component, vcl/Control, vcl/Dragger, util/Command, util/HotkeyManager, vcl/ui/Sizer, vcl/ui/FormContainer, entities/EM, entities/ExpressionBuilder, util/Rest, features/FM\";var Component=require(\"vcl/Component\");var Control=require(\"vcl/Control\");var FormContainer=require(\"vcl/ui/FormContainer\");var Sizer=require(\"vcl/ui/Sizer\");var Command=require(\"util/Command\");var Rest=require(\"util/Rest\");var Deferred=require(\"js/Deferred\");var JsObject=require(\"js/JsObject\");var Dragger=require(\"vcl/Dragger\");$([\"ui/Form\"],{activeControl:\"console\",align:\"bottom\",height:250,visible:true,css:\"background-color: white border-top: 1px solid silver z-index: 10000\",onActivate(){this._vars.sizer.setControl(null);},onLoad(){var me=this;var scope=this.getScope();var sizer=this.setVar(\"sizer\",new Sizer(this));var app=this.getApp();app.on(\"print\",function(){console.log(\"app.on('print', ...)\");scope.console.print.apply(scope.console,arguments);});var parent=this.scope()[this.getVar(\"parent\")];if(parent){this.setParent(parent);}\ndocument.body.style.overflow=\"hidden\";sizer.on(\"setControl\",function(value){var content=[];var consoles=this.app().qsa(\"vcl/ui/Console\").filter(c=>c.isVisible());if(value!==null){if(value.getUri()){var root=value.isRootComponent()?\":root\":\"\";var uri=value.isRootComponent()?value._uri:value.getUri();var selected=value.isSelected&&value.isSelected()?\":selected\":\"\";var disabled=value.isEnabled&&value.isEnabled()?\"\":\":disabled\";content.push(js.sf(\"%s%s%s%s\",uri,root,selected,disabled));}\ncontent.push(js.sf(\"%n\",value));if(sizer.getVar(\"meta\")===true){consoles.forEach(c=>c.getNode(\"input\").value=js.sf(\"[#%d, \\\"%s\\\"]\",value.hashCode(),content.join(\"\\\", \\\"\")));}else{consoles.forEach(c=>c.getNode(\"input\").value=js.sf(\"#%d\",value.hashCode()));consoles.forEach(c=>c.focus());}\nif(value._owner){content.push(String.format(\"%n\",value._owner));}}\nscope.sizer_selection.setContent(String.format(\"%H\",content.join(\" - \")));},true);var down;app._dispatcher.override({dispatch:function(component,name,evt){if(evt.keyCode===27){if(sizer._control!==null){if(name===\"keydown\"){down=Date.now();if(evt.altKey===true){var root=sizer._control.up();sizer.setControl(root===app?null:root);}else if(evt.shiftKey===true){sizer.setControl(null);}else{sizer.setControl(sizer._control._parent);}}\nif(name===\"keyup\"){return false;}}}\nif(name===\"dblclick\"&&evt.altKey===true){sizer.setControl(component);var consoles=me.app().qsa(\"vcl/ui/Console\").filter(c=>c.isVisible());if(consoles.length===0){me.ud(\"#toggle-console\").execute({});}\nconsoles.forEach(_=>{_.getNode(\"input\").value=\"\";_.print(js.sf(\"#%d\",component.hashCode()),component);});}else if(name===\"click\"&&evt.altKey===true){sizer.setVar(\"meta\",evt.metaKey===true);if(evt.shiftKey===false){if(component instanceof Control){if(sizer._control===component){component=null;}\nsizer.setControl(component);return false;}}else{var fc=component;while(fc instanceof Control){if(fc instanceof FormContainer){if(evt.metactrlKey===true){var keys=Component.getKeysByUri(fc._formUri);if(confirm(String.format(\"Rescaffold %s?\",fc.getForm().getUri()))===true){fc.reloadForm();return false;}}else{if(confirm(String.format(\"Reload %s?\",fc.getForm().getUri()))===true){fc.reloadForm();return false;}}}\nfc=fc._parent;}}}else if(name===\"touchstart\"||name===\"touchmove\"){if(evt.touches.length>3){app.getScope().toggle_console.execute(evt);}}\nreturn this.inherited(arguments);}});return this.inherited(arguments);},onHide(){var focused=Control.focused;var scope=this.getScope();if(focused===scope.console){scope.console.getNode(\"input\").blur();}}},[$([\"ui/controls/Toolbar\"],\"toolbar\",{css:{cursor:\"ns-resize\"},draggable:true,onDraggerNeeded(){var control=this._owner;var dragger=new Dragger(this);dragger.setCursor(\"ns-resize\");dragger.override({updateHandles:function(evt){control.setHeight(control.getHeight()-(evt.clientY-this._sy));this._sy=evt.clientY;}});return dragger;}},[$(\"vcl/ui/Element\",\"sizer_selection\",{css:\"padding: 4px; display: inline-block; cursor: default;\"}),$([[\"ui/controls/SizeHandle\"]],\"size_handle\",{classes:\"vertical\",vars:{control:\"@owner\"}})]),$((\"vcl/ui/Console\"),\"console\",{onLoad(){this.up().print(\"document\",window.location);},onEvaluate(expr){var scope=this.scope();var app=this.app();var pr=this.print.bind(this);var me=this;function open(uri,opts){me.bubble(\"openform\",js.mixIn(js.mixIn(opts||{}),{uri:uri}));}\nfunction runAtServer(c,params,content){return Command.execute(c,params,content);}\nif(expr.charAt(scope||Documents||0)===\":\"){expr=expr.substring(1).split(\" \");if(expr.length>0){expr=String.format(\"Utils.%s(scope, %s)\",expr.shift(),expr.join(\" \"));}else{expr=String.format(\"Utils.%s(scope)\",expr.shift());}}\nif(expr===\"@!\"){expr=\"@ reset()\";}\nif(expr.substring(0,1)===\"@\"){if(expr.substring(0,2)===\"@(\"){expr=\"runAtServer(\"+expr.substring(2);}else{expr=String.format(\"runAtServer(\\\"scaffold.js/lib/eval\\\", %s);\",JSON.stringify({text:expr.substring(1)}));}}\nreturn eval(expr);}})]);");
define("text!vcl/prototypes/App.openform.js", "\"vcl/ui/Element, vcl/ui/FormContainer\";var FormContainer=require(\"vcl/ui/FormContainer\");$([],{onLoad:function(){var scope=this.scope(),delegate;this.on({\"open:form\":function(evt){if(evt.modal===true){scope.openform_modal.execute(evt);}else{if(delegate===undefined){delegate=scope.client.getForm().scope().open_form;}\ndelegate.execute(evt.uri,evt);}}});this.popup=function(uri,opts){opts=js.mixIn(opts);opts.uri=uri;return this.bubble(\"openform_modal\",opts);};return this.inherited(arguments);},onMessage:function(name,msg,sender){var scope=this.getScope();if(name===\"openform\"||name===\"openform-tabbed\"){scope=scope.client.getForm().getScope();scope.open_form.execute(msg.uri,msg);}else if(name===\"openform_modal\"){scope.openform_modal.execute(msg,sender);}else if(name===\"log\"){scope.console.sendMessage(name,msg,sender);}},},[$(\"vcl/Action\",\"openform_modal\",{onExecute:function(evt){var app=this.getApp();var scope=this.getScope();var app_scope=app.getScope();var container=new FormContainer(app);var client=app_scope.modal_client;var cs=scope.modal_client.getComputedStyle();var w=evt.width||0.75;var h=evt.height||0.75;if(w<1){w=parseInt(cs.width)*w;}\nif(h<1){h=parseInt(cs.height)*h;}\nscope.modal_client.bringToFront();var width=parseInt(cs.width);container.setAlign(\"none\");container.setAutoSize(\"both\");container._autoPosition={left:true,top:true};container.setCss({\"background-color\":\"white\",\"z-index\":\"201\",\"border-radius\":\"12px\",\"border\":\"1px solid transparent\",\"box-shadow\":\"4px 4px 15px 2px rgba(128, 128, 128, 0.7)\",\"left\":String.format(\"%dpx\",width/2-w/2),\"top\":String.format(\"%dpx\",evt.top||70),\"width\":String.format(\"%dpx\",w),\"height\":String.format(\"%dpx\",h),\"overflow\":\"hidden\",\"&.animate\":{\"-webkit-transition-property\":\"-webkit-transform, opacity, all\",\"-webkit-transition-duration\":\"0.2s, 0.3s, 0.3s\",\"&.fadein-scale\":{\"-webkit-transform\":\"scale(1)\",\"opacity\":\"1\",\"&.initial\":{\"-webkit-transform\":\"scale(0.9)\",\"opacity\":\"0\"}}}});if(evt.uri){container.setFormUri(evt.uri);}else if(evt.form){container.swapForm(evt.form,false);evt.form.show();}\nif(typeof evt.params===\"function\"){container.setFormParams(evt.params());}else if(evt.params){container.setFormParams(evt.params);}\nclient.addClasses(\"animate darken initial\");container.addClasses(\"animate fadein-scale initial\");container.setParentNode(app.down(\"#window\").getNode());container.setOnFormClose(function(){client.applyVar(\"cancel\");});container.setOnFormLoad(function(){if(typeof evt.callback===\"function\"){evt.callback(this._form);}});container.setTimeout(\"x\",function(){client.removeClass(\"initial\",true);container.removeClass(\"initial\",true);},100);var containers=client.getVar(\"containers\",false,[]);containers.push(container);}}),$i(\"window\",[$(\"vcl/ui/Panel\",\"modal_client\",{css:{\"pointer-events\":\"none\",\"visibility\":\"hidden\",\"&.animate\":{\"-webkit-transition\":\"background-color 0.2s\",\"visibility\":\"inherit\",\"pointer-events\":\"all\",\"background-color\":\"white\",\"&.darken\":{opacity:\"0.6\",\"&.initial\":{opacity:\"0\"}}}},align:\"client\",onTap:function(){var containers=this.getVar(\"containers\");var scope=this.getScope();if(containers.length>0){var form=containers[containers.length-1]._form;if(form){form.close();}else{scope.modal_client.applyVar(\"cancel\");}}},onResize:function(){var containers=this.getVar(\"containers\");if(containers){var scope=this.getScope();var cw=parseInt(scope.modal_client.getComputedStyle().width);containers.forEach(function(container){var width=container.getWidth();container.setBounds(cw/2-width/2,undefined,undefined,undefined,undefined,undefined);});}},vars:{cancel:function(){var containers=this.getVar(\"containers\");var container=containers.pop();var modal_client=this;container.addClass(\"initial\",true);this.addClass(\"initial\",true);container.on({\"transitionend\":function(){modal_client.removeClasses(\"animate darken initial\",true);container._form.setParent(null);delete container._form;container.destroy();}});}}})])]);");
define("text!vcl-comps/devtools/Editor$/js.js", "$([],{onLoad(){var ace=this.down(\"#ace\"),firstRun=false;ace.up().readStorage(\"ace\",function(state){firstRun=state===undefined;});this.up(\"vcl/ui/Tab\").once(\"resource-loaded\",()=>{if(firstRun===true){var editor=ace.getEditor();editor.execCommand(\"foldall\");var fold=editor.session.getAllFolds()[0];fold&&editor.session.expandFold(fold);}});return this.inherited(arguments);}});");
define("text!vcl-comps/devtools/Workspace$/vcl.js", "$([\"devtools/Workspace\"],{vars:{\"#navigator favorites\":[\"Workspaces/cavalion.org/cavalion-js/src\",\"Workspaces/cavalion.org/cavalion-vcl/src\",\"Workspaces/cavalion.org/cavalion-js/CHANGELOG.md;js/CHANGELOG.md;File\",\"Workspaces/cavalion.org/cavalion-vcl/CHANGELOG.md;vcl/CHANGELOG.md;File\"]},handlers:{\"loaded\":function(){}}});");
define("text!vcl-comps/devtools/Workspace$/blocks.js", "\"use devtools/Resources-dropbox\";[[],{vars:{\"#navigator favorites\":[\"Library/cavalion-blocks/devtools;;Folder\",\"Library/cavalion-blocks/docs;;Folder\",\"Library/cavalion-blocks/ide;;Folder\",\"Library/cavalion-blocks/prototypes;;Folder\",\"Library/cavalion-blocks/veldapps;;Folder\"],},onLoad:function(){var fs=this.down(\"#tree < #fs\");this.setVar(\"Resources\",fs.getVar(\"Resources\"));var keys=require(\"vcl/Component\").getKeysByUri;if((keys=keys(this._uri)).specializer_classes.length>0){return;}\nvar ws_needed=this.udown(\"#workspace-needed\");var ws_index=this.up(\"vcl/ui/Tab\").getIndex();this.vars(\"additional-workspaces\",false,[]).map(function(ws,index){var tab=ws_needed.execute({workspace:{name:keys.specializer+\"/\"+ws,selected:false}});if(ws===\"build\"){tab.setIndex(ws_index+index);}else{tab.setIndex(ws_index+index+1);}\nreturn tab;});return this.inherited(arguments);}}];");