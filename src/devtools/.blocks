function getDb() { return OM.db; }

["Container", {
	onLoad: function() {
		var ws = this.up("devtools/Workspace<>:root");
		var fs = ws.down("#tree < #fs");
		var NavigatorNode = fs.constructor;

		var node = new NavigatorNode({
			vars: { 
				resource: { 
					uri: "pouchdb://va_objects",
					name: "va-objects", 
					type: "Folder"
				}
			},
			owner: this,
			parent: this.scope().node,
			expandable: true,
			onNodesNeeded: function() {
				var fs = this.up("devtools/Workspace<>").down("#navigator #fs");
				return fs._onChildNodesNeeded.apply(fs, arguments);
			}
		});

		// must have a Resources implementation, take it from fs		
		this.setVar("Resources", fs.getVar("Resources"));
		// require("devtools/Resources-pouchdb").list = function(uri) {
		// 	var db = uri.split("/").shift(); 

		// 	if(!uri.endsWith("/")) uri += "/";

 	// 		return getDb(uri).allDocs().then(function(all) {
 	// 			var all = all.rows.map(_ => db + "/" + _.id);
	 //			return all.filter(db_id => db_id.startsWith(uri))
		// 			.map(db_id => db_id.substring(uri.length).split("/").shift())
		// 			.filter(function(name, index, arr) { return name.length > 0 && arr.indexOf(name) === index; })
		// 			.map(name => ({name: name, uri: uri + name, type: all.indexOf(uri + name) !== -1 ? "File" : "Folder"}));
 	// 		});
		// };
	},
	css: js.sf("background-color: %s;", (["red", "yellow", "green", "blue"])[Math.floor(Math.random() * 4)])
}, [
	["Node", "node", {
		text: "Databases",
		visible: false,
		classes: "root-invisible folder seperator",
		expanded: true,
		onLoad: function() {
			var fs = this.up("devtools/Workspace<>").down("#navigator #fs");
			this.setParent(fs);
			this.show();
		},
		onNodesNeeded: function() {}
	}]

]];